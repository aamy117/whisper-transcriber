# å¤§æª”æ¡ˆè™•ç†ç³»çµ± (Large File Processing System)

é€™å€‹ç›®éŒ„åŒ…å«äº†æ–°çš„å¤§æª”æ¡ˆè™•ç†ç³»çµ±çš„æ‰€æœ‰æ¨¡çµ„ã€‚é€™æ˜¯ä¸€å€‹ä¸¦è¡Œé–‹ç™¼çš„ç³»çµ±ï¼Œä¸æœƒå½±éŸ¿ç¾æœ‰çš„è½‰è­¯åŠŸèƒ½ã€‚

## ğŸ“ ç›®éŒ„çµæ§‹

```
large-file/
â”œâ”€â”€ large-file-controller.js      # ä¸»æ§åˆ¶å™¨ - çµ±ä¸€çš„è™•ç†ä»‹é¢
â”œâ”€â”€ large-file-config.js         # é…ç½®ç®¡ç† - åŠŸèƒ½é–‹é—œå’Œåƒæ•¸è¨­å®š
â”œâ”€â”€ stream-analyzer.js           # ä¸²æµåˆ†æå™¨ - ç„¡è¨˜æ†¶é«”ä½”ç”¨çš„æª”æ¡ˆåˆ†æ
â”œâ”€â”€ smart-splitter.js           # æ™ºæ…§åˆ†å‰²å™¨ - åŸºæ–¼çµæ§‹çš„æª”æ¡ˆåˆ†å‰²
â”œâ”€â”€ parallel-processor.js       # ä¸¦è¡Œè™•ç†å™¨ - Web Worker ç®¡ç†
â”œâ”€â”€ progress-checkpoint.js      # é€²åº¦æª¢æŸ¥é» - ä¸­æ–·æ¢å¾©æ©Ÿåˆ¶
â”œâ”€â”€ cache-manager.js           # å¿«å–ç®¡ç†å™¨ - æ™ºæ…§å¿«å–ç­–ç•¥
â”œâ”€â”€ memory-monitor.js          # è¨˜æ†¶é«”ç›£æ§ - å¯¦æ™‚ç›£æ§å’Œå„ªåŒ–
â”œâ”€â”€ performance-optimizer.js    # æ•ˆèƒ½å„ªåŒ–å™¨ - å‹•æ…‹èª¿æ•´è™•ç†ç­–ç•¥
â”œâ”€â”€ workers/                   # Web Workers ç›®éŒ„
â”‚   â”œâ”€â”€ audio-analysis-worker.js
â”‚   â”œâ”€â”€ audio-split-worker.js
â”‚   â”œâ”€â”€ audio-encode-worker.js
â”‚   â””â”€â”€ worker-pool-manager.js
â”œâ”€â”€ utils/                     # å·¥å…·å‡½æ•¸ç›®éŒ„
â”‚   â”œâ”€â”€ file-format-detector.js
â”‚   â”œâ”€â”€ byte-range-reader.js
â”‚   â””â”€â”€ audio-metadata-parser.js
â””â”€â”€ strategies/               # æ ¼å¼ç‰¹å®šç­–ç•¥ç›®éŒ„
    â”œâ”€â”€ mp3-split-strategy.js
    â”œâ”€â”€ wav-split-strategy.js
    â””â”€â”€ generic-split-strategy.js
```

## ğŸš€ å¿«é€Ÿé–‹å§‹

### 1. åŠŸèƒ½é–‹é—œ

é è¨­æƒ…æ³ä¸‹ï¼Œæ–°ç³»çµ±æ˜¯é—œé–‰çš„ã€‚è¦å•Ÿç”¨å®ƒï¼Œè«‹åœ¨ `large-file-config.js` ä¸­è¨­å®šï¼š

```javascript
export const config = {
  enabled: true,  // å•Ÿç”¨æ–°ç³»çµ±
  thresholdMB: 100  // æª”æ¡ˆå¤§å°é–¾å€¼
};
```

### 2. æ•´åˆæ–¹å¼

æ–°ç³»çµ±é€éæœ€å°åŒ–çš„æ•´åˆé»èˆ‡ç¾æœ‰ç³»çµ±é€£æ¥ï¼š

```javascript
// åœ¨ transcription-preprocessor.js ä¸­
if (shouldUseLargeFileSystem(file)) {
  return await largeFileController.process(file, options);
}
```

### 3. æ¸¬è©¦

ä½¿ç”¨å°ˆé–€çš„æ¸¬è©¦é é¢é€²è¡Œæ¸¬è©¦ï¼š
- `test/test-large-file-v2.html` - åŠŸèƒ½æ¸¬è©¦
- `test/test-large-file-performance.html` - æ•ˆèƒ½æ¸¬è©¦

## ğŸ“Š ç³»çµ±ç‰¹é»

1. **é›¶è¨˜æ†¶é«”ä½”ç”¨**ï¼šä½¿ç”¨ä¸²æµè™•ç†ï¼Œè¨˜æ†¶é«”ä½¿ç”¨å¾ O(n) é™åˆ° O(1)
2. **ä¸¦è¡Œè™•ç†**ï¼šå¤šå€‹ Web Workers åŒæ™‚è™•ç†ï¼Œé€Ÿåº¦æå‡ 3-5 å€
3. **ä¸­æ–·æ¢å¾©**ï¼šæ”¯æ´è™•ç†ä¸­æ–·å¾Œå¾æª¢æŸ¥é»æ¢å¾©
4. **è‡ªå‹•é™ç´š**ï¼šé‡åˆ°éŒ¯èª¤è‡ªå‹•é™ç´šåˆ°èˆŠç³»çµ±
5. **é€æ˜ç›£æ§**ï¼šå¯¦æ™‚æ•ˆèƒ½ç›£æ§å’Œçµ±è¨ˆ

## ğŸ”§ é–‹ç™¼æŒ‡å—

### æ·»åŠ æ–°åŠŸèƒ½

1. æ‰€æœ‰æ–°åŠŸèƒ½éƒ½æ‡‰è©²åœ¨é€™å€‹ç›®éŒ„ä¸‹é–‹ç™¼
2. ä¸è¦ä¿®æ”¹ç¾æœ‰ç³»çµ±çš„æ ¸å¿ƒæª”æ¡ˆ
3. ä½¿ç”¨åŠŸèƒ½é–‹é—œæ§åˆ¶æ–°åŠŸèƒ½çš„å•Ÿç”¨

### éŒ¯èª¤è™•ç†

æ‰€æœ‰æ¨¡çµ„éƒ½æ‡‰è©²å¯¦ç¾å„ªé›…çš„éŒ¯èª¤è™•ç†ï¼š

```javascript
try {
  // æ–°ç³»çµ±è™•ç†é‚è¼¯
} catch (error) {
  console.warn('æ–°ç³»çµ±è™•ç†å¤±æ•—ï¼Œé™ç´šåˆ°èˆŠç³»çµ±', error);
  return fallbackToLegacySystem();
}
```

### æ•ˆèƒ½ç›£æ§

ä½¿ç”¨å…§å»ºçš„æ•ˆèƒ½ç›£æ§å™¨è¿½è¹¤è™•ç†æ•ˆèƒ½ï¼š

```javascript
performanceMonitor.track('split', {
  duration: endTime - startTime,
  memoryUsed: performance.memory.usedJSHeapSize,
  segmentsCreated: segments.length
});
```

## ğŸ“ˆ é–‹ç™¼é€²åº¦

- [x] å»ºç«‹ç›®éŒ„çµæ§‹
- [ ] å¯¦ç¾é…ç½®ç®¡ç†ç³»çµ±
- [ ] å¯¦ç¾ä¸»æ§åˆ¶å™¨
- [ ] å¯¦ç¾ä¸²æµåˆ†æå™¨
- [ ] å¯¦ç¾æ™ºæ…§åˆ†å‰²å™¨
- [ ] å¯¦ç¾ä¸¦è¡Œè™•ç†å™¨
- [ ] å¯¦ç¾é€²åº¦æª¢æŸ¥é»
- [ ] å¯¦ç¾å¿«å–ç®¡ç†
- [ ] æ•´åˆæ¸¬è©¦
- [ ] æ•ˆèƒ½å„ªåŒ–
- [ ] ç”Ÿç”¢ç’°å¢ƒéƒ¨ç½²

## ğŸ¤ è²¢ç»æŒ‡å—

1. æ‰€æœ‰ç¨‹å¼ç¢¼éƒ½æ‡‰è©²éµå¾ªç¾æœ‰çš„ç·¨ç¢¼é¢¨æ ¼
2. æ·»åŠ é©ç•¶çš„è¨»é‡‹å’Œæ–‡æª”
3. ç¢ºä¿æ‰€æœ‰æ¸¬è©¦é€šé
4. æäº¤å‰é€²è¡Œç¨‹å¼ç¢¼å¯©æŸ¥

## ğŸ“ è¯çµ¡æ–¹å¼

å¦‚æœ‰å•é¡Œæˆ–å»ºè­°ï¼Œè«‹åœ¨å°ˆæ¡ˆçš„ GitHub Issues ä¸­æå‡ºã€‚