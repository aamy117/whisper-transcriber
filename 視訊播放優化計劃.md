詳細的 MSE 實施方案。

● 移除播放限制並實施 MSE 串流的最佳方案

  基於對現有程式碼的分析，我建議以下實施策略：

  1. 架構設計原則

  漸進式增強：
  - 保留現有的 URL.createObjectURL 作為小檔案的快速載入方式
  - 為大檔案實施 MSE 串流
  - 自動根據檔案大小選擇最佳策略

  模組化設計：
  視訊載入策略
  ├── DirectLoader (現有方式，< 100MB)
  ├── StreamingLoader (MSE，>= 100MB)
  └── 自動選擇器

  2. 核心組件規劃

  A. StreamingLoader 類別
  class StreamingLoader {
    - 使用 FileReader 分塊讀取檔案
    - 管理 MediaSource 和 SourceBuffer
    - 實施智慧緩衝策略
    - 處理 seeking 和預載入
  }

  B. ChunkManager 類別
  class ChunkManager {
    - 管理檔案分塊（建議 1-5MB per chunk）
    - 預測性載入（根據播放位置）
    - 記憶體回收（清理已播放的塊）
    - 優先載入策略
  }

  C. 修改 VideoPlayer
  class VideoPlayer {
    - 新增 loadingStrategy 屬性
    - 根據檔案大小自動選擇載入器
    - 保持相同的公開 API
    - 向後相容
  }

  3. 實施步驟

  第一階段：基礎 MSE 實施
  1. 建立 video-streaming.js 模組
  2. 實施基本的 MSE 載入功能
  3. 支援 MP4 和 WebM（最常見格式）
  4. 測試基本播放功能

  第二階段：效能優化
  1. 實施智慧緩衝管理
  2. 加入預載入邏輯
  3. 優化 seeking 效能
  4. 加入記憶體管理

  第三階段：完整整合
  1. 整合到現有的 VideoPlayer
  2. 實施自動策略選擇
  3. 更新 UI 顯示（緩衝進度等）
  4. 移除檔案大小限制

  4. 技術細節考量

  格式支援：
  - MP4：需要 'video/mp4; codecs="avc1.42E01E, mp4a.40.2"'
  - WebM：需要 'video/webm; codecs="vorbis,vp8"'
  - 需要動態檢測編碼格式

  緩衝策略：
  當前播放位置 ← [已緩衝 10MB] → [緩衝中 5MB] → [預載入 5MB] →
  未載入部分

  Seeking 處理：
  - 清理不需要的緩衝
  - 優先載入 seek 位置的資料
  - 保持流暢的使用者體驗

  5. 相容性考量

  瀏覽器支援：
  - Chrome/Edge：完整支援
  - Firefox：完整支援
  - Safari：部分支援（需要特別處理）
  - 需要 fallback 機制

  檔案格式：
  - 容器格式必須支援分段（MP4 需要 fragmented MP4）
  - 可能需要使用 mp4box.js 處理非分段 MP4

  6. 使用者體驗改進

  新增 UI 元素：
  - 緩衝進度顯示（多段）
  - 載入速度指示
  - 記憶體使用量（開發模式）

  效能指標：
  - 首次播放時間
  - 緩衝次數
  - 平均載入速度

  7. 設定建議

  // video-config.js 更新
  streaming: {
    enabled: true,
    chunkSize: 2 * 1024 * 1024, // 2MB chunks
    bufferSize: 20 * 1024 * 1024, // 20MB buffer
    threshold: 100 * 1024 * 1024, // 100MB 以上使用串流
    preloadSize: 5 * 1024 * 1024, // 預載 5MB
  }

  8. 錯誤處理

  需要處理的新錯誤類型：
  - MediaSource 不支援
  - SourceBuffer 錯誤
  - 編碼不相容
  - 緩衝區滿
  - 網路中斷（本地檔案較少見）

  這個方案可以完全移除檔案大小限制，同時提供更好的效能和使用者體驗。      
  實施時建議保持向後相容，確保現有功能不受影響。