<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¤§æª”æ¡ˆè™•ç†ç³»çµ± - ç«¯åˆ°ç«¯æ¸¬è©¦</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        .card {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            margin-bottom: 30px;
        }
        h2 {
            color: #666;
            margin-top: 0;
        }
        .test-controls {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        button {
            padding: 10px 20px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover:not(:disabled) {
            background: #0056b3;
        }
        button:disabled {
            background: #6c757d;
            cursor: not-allowed;
        }
        .file-input-wrapper {
            position: relative;
            display: inline-block;
        }
        .file-input-wrapper input[type="file"] {
            position: absolute;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }
        .file-info {
            background: #e9ecef;
            padding: 15px;
            border-radius: 4px;
            margin-bottom: 20px;
        }
        .status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }
        .status-card {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 4px;
            border-left: 4px solid #007bff;
        }
        .status-card.success {
            border-left-color: #28a745;
        }
        .status-card.warning {
            border-left-color: #ffc107;
        }
        .status-card.error {
            border-left-color: #dc3545;
        }
        .status-label {
            color: #666;
            font-size: 14px;
            margin-bottom: 5px;
        }
        .status-value {
            font-size: 18px;
            font-weight: bold;
            color: #333;
        }
        .progress-container {
            background: #e9ecef;
            border-radius: 4px;
            padding: 4px;
            margin: 20px 0;
        }
        .progress-bar {
            background: #007bff;
            height: 30px;
            border-radius: 2px;
            transition: width 0.3s;
            position: relative;
            overflow: hidden;
        }
        .progress-text {
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-weight: bold;
        }
        .log {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 14px;
            max-height: 400px;
            overflow-y: auto;
        }
        .log-entry {
            margin: 5px 0;
            padding: 5px;
            border-left: 3px solid #007bff;
            padding-left: 10px;
        }
        .log-entry.error {
            border-left-color: #dc3545;
            background: #fff5f5;
        }
        .log-entry.success {
            border-left-color: #28a745;
            background: #f5fff5;
        }
        .log-entry.warning {
            border-left-color: #ffc107;
            background: #fffdf5;
        }
        .result-section {
            background: #e9ecef;
            padding: 15px;
            border-radius: 4px;
            margin-top: 20px;
        }
        .config-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        .config-item {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        .config-item label {
            font-weight: bold;
            color: #666;
        }
        .config-item input,
        .config-item select {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }
        .metrics-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        .metrics-table th,
        .metrics-table td {
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        .metrics-table th {
            background: #f8f9fa;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ§ª å¤§æª”æ¡ˆè™•ç†ç³»çµ± - ç«¯åˆ°ç«¯æ¸¬è©¦</h1>

        <!-- é…ç½®å€åŸŸ -->
        <div class="card">
            <h2>âš™ï¸ ç³»çµ±é…ç½®</h2>
            <div class="config-section">
                <div class="config-item">
                    <label for="enableSystem">å•Ÿç”¨å¤§æª”æ¡ˆè™•ç†ç³»çµ±</label>
                    <select id="enableSystem">
                        <option value="true">å•Ÿç”¨</option>
                        <option value="false">åœç”¨</option>
                    </select>
                </div>
                <div class="config-item">
                    <label for="sizeThreshold">æª”æ¡ˆå¤§å°é–¾å€¼ (MB)</label>
                    <input type="number" id="sizeThreshold" value="50" min="1" max="1000">
                </div>
                <div class="config-item">
                    <label for="workerCount">Worker æ•¸é‡</label>
                    <input type="number" id="workerCount" value="4" min="1" max="16">
                </div>
                <div class="config-item">
                    <label for="chunkSize">å€å¡Šå¤§å° (MB)</label>
                    <input type="number" id="chunkSize" value="5" min="1" max="25">
                </div>
            </div>
            <button id="applyConfig">å¥—ç”¨é…ç½®</button>
        </div>

        <!-- æª”æ¡ˆé¸æ“‡ -->
        <div class="card">
            <h2>ğŸ“ é¸æ“‡æ¸¬è©¦æª”æ¡ˆ</h2>
            <div class="file-input-wrapper">
                <button onclick="document.getElementById('fileInput').click(); return false;">é¸æ“‡éŸ³è¨Šæª”æ¡ˆ</button>
                <input type="file" id="fileInput" accept="audio/*,video/*" style="display: none;">
            </div>
            <br>
            <p style="color: #666; font-size: 14px;">æ”¯æ´æ ¼å¼ï¼šMP3, WAV, M4A, AAC, OGG, FLAC ç­‰</p>
            <div id="fileInfo" class="file-info" style="display: none;">
                <p><strong>æª”æ¡ˆåç¨±ï¼š</strong><span id="fileName">--</span></p>
                <p><strong>æª”æ¡ˆå¤§å°ï¼š</strong><span id="fileSize">--</span></p>
                <p><strong>æª”æ¡ˆé¡å‹ï¼š</strong><span id="fileType">--</span></p>
                <p><strong>è™•ç†å»ºè­°ï¼š</strong><span id="processRecommendation">--</span></p>
            </div>
        </div>

        <!-- æ¸¬è©¦æ§åˆ¶ -->
        <div class="card">
            <h2>ğŸš€ æ¸¬è©¦æ§åˆ¶</h2>
            <div class="test-controls">
                <button id="startTest" disabled>é–‹å§‹å®Œæ•´æ¸¬è©¦</button>
                <button id="pauseTest" disabled>æš«åœè™•ç†</button>
                <button id="resumeTest" disabled>æ¢å¾©è™•ç†</button>
                <button id="cancelTest" disabled>å–æ¶ˆè™•ç†</button>
                <button id="viewStats">æŸ¥çœ‹ç³»çµ±çµ±è¨ˆ</button>
            </div>
        </div>

        <!-- é€²åº¦é¡¯ç¤º -->
        <div class="card">
            <h2>ğŸ“Š è™•ç†é€²åº¦</h2>
            <div class="progress-container">
                <div class="progress-bar" id="progressBar" style="width: 0%">
                    <span class="progress-text" id="progressText">0%</span>
                </div>
            </div>
            <p id="progressMessage">ç­‰å¾…é–‹å§‹...</p>
        </div>

        <!-- ç‹€æ…‹ç›£æ§ -->
        <div class="card">
            <h2>ğŸ“ˆ å³æ™‚ç‹€æ…‹</h2>
            <div class="status-grid" id="statusGrid">
                <div class="status-card">
                    <div class="status-label">è™•ç†éšæ®µ</div>
                    <div class="status-value" id="currentPhase">--</div>
                </div>
                <div class="status-card">
                    <div class="status-label">å·²è™•ç†ç‰‡æ®µ</div>
                    <div class="status-value" id="processedSegments">0 / 0</div>
                </div>
                <div class="status-card">
                    <div class="status-label">è¨˜æ†¶é«”ä½¿ç”¨</div>
                    <div class="status-value" id="memoryUsage">--</div>
                </div>
                <div class="status-card">
                    <div class="status-label">è™•ç†é€Ÿåº¦</div>
                    <div class="status-value" id="processingSpeed">--</div>
                </div>
            </div>
        </div>

        <!-- æ•ˆèƒ½æŒ‡æ¨™ -->
        <div class="card">
            <h2>âš¡ æ•ˆèƒ½æŒ‡æ¨™</h2>
            <table class="metrics-table">
                <thead>
                    <tr>
                        <th>æŒ‡æ¨™</th>
                        <th>æ•¸å€¼</th>
                        <th>ç‹€æ…‹</th>
                    </tr>
                </thead>
                <tbody id="metricsBody">
                    <tr>
                        <td>ç¸½è™•ç†æ™‚é–“</td>
                        <td id="totalTime">--</td>
                        <td id="totalTimeStatus">--</td>
                    </tr>
                    <tr>
                        <td>å¹³å‡ååé‡</td>
                        <td id="avgThroughput">--</td>
                        <td id="avgThroughputStatus">--</td>
                    </tr>
                    <tr>
                        <td>Worker æ•ˆç‡</td>
                        <td id="workerEfficiency">--</td>
                        <td id="workerEfficiencyStatus">--</td>
                    </tr>
                    <tr>
                        <td>å¿«å–å‘½ä¸­ç‡</td>
                        <td id="cacheHitRate">--</td>
                        <td id="cacheHitRateStatus">--</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- è™•ç†çµæœ -->
        <div class="card">
            <h2>ğŸ“ è™•ç†çµæœ</h2>
            <div id="result" class="result-section">
                <p>ç­‰å¾…è™•ç†å®Œæˆ...</p>
            </div>
        </div>

        <!-- ç³»çµ±æ—¥èªŒ -->
        <div class="card">
            <h2>ğŸ“‹ ç³»çµ±æ—¥èªŒ</h2>
            <div id="log" class="log"></div>
        </div>
    </div>

    <script type="module">
        import { largeFileIntegration } from './js/large-file/large-file-integration.js';
        import { largeFileConfig } from './js/large-file/large-file-config.js';
        import { performanceOptimizer } from './js/large-file/performance-optimizer.js';
        import CancellationToken from './js/utils/cancellation-token.js';

        // UI å…ƒç´ 
        const fileInput = document.getElementById('fileInput');
        const startBtn = document.getElementById('startTest');
        const pauseBtn = document.getElementById('pauseTest');
        const resumeBtn = document.getElementById('resumeTest');
        const cancelBtn = document.getElementById('cancelTest');
        const viewStatsBtn = document.getElementById('viewStats');
        const applyConfigBtn = document.getElementById('applyConfig');
        const logDiv = document.getElementById('log');

        // ç‹€æ…‹
        let selectedFile = null;
        let cancellationToken = null;
        let processingSession = null;
        let startTime = null;

        // æª”æ¡ˆé¸æ“‡
        fileInput.addEventListener('change', (e) => {
            selectedFile = e.target.files[0];
            if (selectedFile) {
                displayFileInfo(selectedFile);
                startBtn.disabled = false;
            }
        });

        // é¡¯ç¤ºæª”æ¡ˆè³‡è¨Š
        function displayFileInfo(file) {
            document.getElementById('fileInfo').style.display = 'block';
            document.getElementById('fileName').textContent = file.name;
            document.getElementById('fileSize').textContent = formatFileSize(file.size);
            document.getElementById('fileType').textContent = file.type || 'æœªçŸ¥';
            
            // å–å¾—è™•ç†å»ºè­°
            const recommendation = largeFileIntegration.getProcessingRecommendation(file);
            const recText = recommendation.useNewSystem ? 
                `å»ºè­°ä½¿ç”¨æ–°ç³»çµ±ï¼ˆ${recommendation.benefits.length} é …å„ªå‹¢ï¼‰` : 
                recommendation.reason;
            document.getElementById('processRecommendation').textContent = recText;
            
            addLog(`å·²é¸æ“‡æª”æ¡ˆ: ${file.name} (${formatFileSize(file.size)})`);
        }

        // å¥—ç”¨é…ç½®
        applyConfigBtn.addEventListener('click', async () => {
            const settings = {
                enabled: document.getElementById('enableSystem').value === 'true',
                thresholdMB: parseInt(document.getElementById('sizeThreshold').value),
                'parallel.maxWorkers': parseInt(document.getElementById('workerCount').value),
                'splitting.defaultChunkSizeMB': parseInt(document.getElementById('chunkSize').value),
            };
            
            await largeFileIntegration.configure(settings);
            addLog('âœ… é…ç½®å·²æ›´æ–°', 'success');
        });

        // é–‹å§‹æ¸¬è©¦
        startBtn.addEventListener('click', async () => {
            if (!selectedFile) return;
            
            startTime = Date.now();
            cancellationToken = new CancellationToken();
            
            startBtn.disabled = true;
            pauseBtn.disabled = false;
            cancelBtn.disabled = false;
            
            addLog('ğŸš€ é–‹å§‹ç«¯åˆ°ç«¯æ¸¬è©¦', 'success');
            
            try {
                // æª¢æŸ¥æ˜¯å¦æ‡‰è©²ä½¿ç”¨å¤§æª”æ¡ˆç³»çµ±
                if (!largeFileIntegration.shouldUseLargeFileSystem(selectedFile)) {
                    addLog('âš ï¸ æª”æ¡ˆä¸ç¬¦åˆå¤§æª”æ¡ˆè™•ç†ç³»çµ±çš„ä½¿ç”¨æ¢ä»¶', 'warning');
                    throw new Error('è«‹é¸æ“‡è¼ƒå¤§çš„æª”æ¡ˆé€²è¡Œæ¸¬è©¦');
                }
                
                // æ¨¡æ“¬ API è½‰è­¯å›èª¿
                const mockTranscribeCallback = async (segment) => {
                    addLog(`ğŸ”„ æ¨¡æ“¬è½‰è­¯ç‰‡æ®µ ${segment.index + 1}/${segment.total}`);
                    
                    // æ¨¡æ“¬ API å»¶é²
                    await new Promise(resolve => setTimeout(resolve, 1000 + Math.random() * 2000));
                    
                    // æ¨¡æ“¬è½‰è­¯çµæœ
                    return {
                        text: `ç‰‡æ®µ ${segment.index + 1} çš„è½‰è­¯æ–‡å­—`,
                        segments: [{
                            start: segment.startTime,
                            end: segment.endTime,
                            text: `ç‰‡æ®µ ${segment.index + 1} çš„å…§å®¹`
                        }],
                        duration: segment.duration
                    };
                };
                
                // è™•ç†æª”æ¡ˆ
                const result = await largeFileIntegration.processLargeFile(selectedFile, {
                    cancellationToken,
                    transcribeCallback: mockTranscribeCallback
                });
                
                // é¡¯ç¤ºçµæœ
                displayResult(result);
                addLog('âœ… æ¸¬è©¦å®Œæˆï¼', 'success');
                
            } catch (error) {
                addLog(`âŒ æ¸¬è©¦å¤±æ•—: ${error.message}`, 'error');
                console.error(error);
            } finally {
                startBtn.disabled = false;
                pauseBtn.disabled = true;
                resumeBtn.disabled = true;
                cancelBtn.disabled = true;
                
                // é¡¯ç¤ºç¸½è™•ç†æ™‚é–“
                if (startTime) {
                    const totalTime = Date.now() - startTime;
                    document.getElementById('totalTime').textContent = formatTime(totalTime);
                    addLog(`ç¸½è™•ç†æ™‚é–“: ${formatTime(totalTime)}`);
                }
            }
        });

        // æš«åœè™•ç†
        pauseBtn.addEventListener('click', () => {
            // TODO: å¯¦ä½œæš«åœåŠŸèƒ½
            pauseBtn.disabled = true;
            resumeBtn.disabled = false;
            addLog('â¸ï¸ è™•ç†å·²æš«åœ', 'warning');
        });

        // æ¢å¾©è™•ç†
        resumeBtn.addEventListener('click', () => {
            // TODO: å¯¦ä½œæ¢å¾©åŠŸèƒ½
            pauseBtn.disabled = false;
            resumeBtn.disabled = true;
            addLog('â–¶ï¸ è™•ç†å·²æ¢å¾©', 'success');
        });

        // å–æ¶ˆè™•ç†
        cancelBtn.addEventListener('click', () => {
            if (cancellationToken) {
                cancellationToken.cancel();
                addLog('ğŸ›‘ è™•ç†å·²å–æ¶ˆ', 'warning');
            }
        });

        // æŸ¥çœ‹çµ±è¨ˆ
        viewStatsBtn.addEventListener('click', async () => {
            const stats = await largeFileIntegration.getStatistics();
            console.log('ç³»çµ±çµ±è¨ˆ:', stats);
            
            if (stats) {
                const report = performanceOptimizer.generateReport();
                console.log('æ•ˆèƒ½å ±å‘Š:', report);
                
                // æ›´æ–°æ•ˆèƒ½æŒ‡æ¨™
                updateMetrics(report);
                
                addLog('ğŸ“Š å·²æ›´æ–°ç³»çµ±çµ±è¨ˆè³‡è¨Š');
            } else {
                addLog('âš ï¸ å¤§æª”æ¡ˆè™•ç†ç³»çµ±æœªå•Ÿç”¨', 'warning');
            }
        });

        // ç›£è½é€²åº¦äº‹ä»¶
        window.addEventListener('large-file-progress', (event) => {
            const progress = event.detail;
            updateProgress(progress);
        });

        // ç›£è½æ•ˆèƒ½å„ªåŒ–äº‹ä»¶
        window.addEventListener('performance-optimization', (event) => {
            const { recommendations } = event.detail;
            if (recommendations.workerCount) {
                addLog(`ğŸ’¡ å»ºè­°: èª¿æ•´ Worker æ•¸é‡ç‚º ${recommendations.workerCount}`);
            }
            if (recommendations.chunkSize) {
                const sizeMB = recommendations.chunkSize / 1024 / 1024;
                addLog(`ğŸ’¡ å»ºè­°: èª¿æ•´å€å¡Šå¤§å°ç‚º ${sizeMB.toFixed(1)} MB`);
            }
        });

        // æ›´æ–°é€²åº¦
        function updateProgress(progress) {
            const percentage = progress.percentage || 0;
            const progressBar = document.getElementById('progressBar');
            const progressText = document.getElementById('progressText');
            const progressMessage = document.getElementById('progressMessage');
            
            progressBar.style.width = `${percentage}%`;
            progressText.textContent = `${percentage}%`;
            progressMessage.textContent = progress.message || 'è™•ç†ä¸­...';
            
            // æ›´æ–°ç‹€æ…‹å¡ç‰‡
            document.getElementById('currentPhase').textContent = progress.phase || '--';
            if (progress.current && progress.total) {
                document.getElementById('processedSegments').textContent = `${progress.current} / ${progress.total}`;
            }
        }

        // æ›´æ–°æ•ˆèƒ½æŒ‡æ¨™
        function updateMetrics(report) {
            if (!report || !report.metrics) return;
            
            const { metrics } = report;
            
            // è¨˜æ†¶é«”ä½¿ç”¨
            if (metrics.memory) {
                const usage = (metrics.memory.averageUsage * 100).toFixed(1);
                document.getElementById('memoryUsage').textContent = `${usage}%`;
                updateStatusCard('memoryUsage', metrics.memory.status);
            }
            
            // Worker æ•ˆç‡
            if (metrics.workers) {
                const efficiency = metrics.workers.averageEfficiency;
                document.getElementById('workerEfficiency').textContent = `${efficiency}%`;
                document.getElementById('workerEfficiencyStatus').textContent = 
                    metrics.workers.status === 'good' ? 'âœ… è‰¯å¥½' : 'âš ï¸ éœ€å„ªåŒ–';
            }
            
            // ååé‡
            if (metrics.throughput) {
                document.getElementById('avgThroughput').textContent = metrics.throughput.average;
                document.getElementById('avgThroughputStatus').textContent = 
                    metrics.throughput.status === 'good' ? 'âœ… è‰¯å¥½' : 'âš ï¸ åä½';
            }
        }

        // æ›´æ–°ç‹€æ…‹å¡ç‰‡
        function updateStatusCard(cardId, status) {
            const card = document.getElementById(cardId).closest('.status-card');
            card.classList.remove('success', 'warning', 'error');
            
            if (status === 'good' || status === 'success') {
                card.classList.add('success');
            } else if (status === 'warning') {
                card.classList.add('warning');
            } else if (status === 'critical' || status === 'error') {
                card.classList.add('error');
            }
        }

        // é¡¯ç¤ºçµæœ
        function displayResult(result) {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = `
                <h3>è™•ç†å®Œæˆ</h3>
                <p><strong>ç¸½æ–‡å­—é•·åº¦ï¼š</strong>${result.text ? result.text.length : 0} å­—å…ƒ</p>
                <p><strong>ç¸½ç‰‡æ®µæ•¸ï¼š</strong>${result.segments ? result.segments.length : 0}</p>
                <p><strong>ç¸½æ™‚é•·ï¼š</strong>${result.duration ? formatTime(result.duration * 1000) : 'æœªçŸ¥'}</p>
                ${result.processingInfo ? `
                    <h4>è™•ç†è³‡è¨Š</h4>
                    <p><strong>åŸå§‹å¤§å°ï¼š</strong>${formatFileSize(result.processingInfo.originalSize)}</p>
                    <p><strong>è™•ç†ç‰‡æ®µï¼š</strong>${result.processingInfo.processedSegments}</p>
                ` : ''}
            `;
        }

        // æ·»åŠ æ—¥èªŒ
        function addLog(message, type = 'info') {
            const entry = document.createElement('div');
            entry.className = `log-entry ${type}`;
            entry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            logDiv.appendChild(entry);
            logDiv.scrollTop = logDiv.scrollHeight;
        }

        // æ ¼å¼åŒ–æª”æ¡ˆå¤§å°
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        // æ ¼å¼åŒ–æ™‚é–“
        function formatTime(ms) {
            const seconds = Math.floor(ms / 1000);
            const minutes = Math.floor(seconds / 60);
            const hours = Math.floor(minutes / 60);
            
            if (hours > 0) {
                return `${hours}å°æ™‚ ${minutes % 60}åˆ†é˜`;
            } else if (minutes > 0) {
                return `${minutes}åˆ†é˜ ${seconds % 60}ç§’`;
            } else {
                return `${seconds}ç§’`;
            }
        }

        // åˆå§‹åŒ–
        async function initialize() {
            // è¼‰å…¥ç•¶å‰é…ç½®
            const config = {
                enabled: await largeFileConfig.get('enabled') || false,
                sizeThreshold: await largeFileConfig.get('thresholdMB') || 50,
                workerCount: await largeFileConfig.get('parallel.maxWorkers') || 4,
                chunkSize: await largeFileConfig.get('splitting.defaultChunkSizeMB') || 5,
            };
            
            document.getElementById('enableSystem').value = config.enabled ? 'true' : 'false';
            document.getElementById('sizeThreshold').value = config.sizeThreshold;
            document.getElementById('workerCount').value = config.workerCount;
            document.getElementById('chunkSize').value = config.chunkSize;
            
            // åˆå§‹åŒ–ç³»çµ±
            await largeFileIntegration.initialize();
            
            addLog('ğŸš€ æ¸¬è©¦é é¢å·²è¼‰å…¥');
            addLog(`å¤§æª”æ¡ˆè™•ç†ç³»çµ±: ${config.enabled ? 'å·²å•Ÿç”¨' : 'å·²åœç”¨'}`);
        }

        // é é¢è¼‰å…¥å®Œæˆå¾Œåˆå§‹åŒ–
        initialize();
        
        // æ·»åŠ é™¤éŒ¯è³‡è¨Š
        addLog(`æª”æ¡ˆè¼¸å…¥å…ƒç´ å­˜åœ¨: ${!!document.getElementById('fileInput')}`);
        addLog(`ç€è¦½å™¨: ${navigator.userAgent.substring(0, 50)}...`);
    </script>
</body>
</html>