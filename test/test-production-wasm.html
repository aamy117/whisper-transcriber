<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç”Ÿç”¢ç’°å¢ƒ WASM æ¸¬è©¦ - Whisper Transcriber</title>
    <link rel="stylesheet" href="../css/style.css">
    <style>
        .test-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .test-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 10px;
            margin-bottom: 30px;
            text-align: center;
        }

        .test-section {
            background: white;
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .test-section h2 {
            color: #333;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .test-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .test-card {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 20px;
            transition: transform 0.2s;
        }

        .test-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .test-card h3 {
            color: #495057;
            margin-bottom: 15px;
            font-size: 1.1rem;
        }

        .test-button {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: background 0.3s;
            margin-right: 10px;
            margin-bottom: 10px;
        }

        .test-button:hover {
            background: #5a67d8;
        }

        .test-button:disabled {
            background: #cbd5e0;
            cursor: not-allowed;
        }

        .test-button.success {
            background: #48bb78;
        }

        .test-button.error {
            background: #f56565;
        }

        .test-result {
            margin-top: 15px;
            padding: 15px;
            border-radius: 5px;
            font-family: monospace;
            font-size: 13px;
            white-space: pre-wrap;
            max-height: 300px;
            overflow-y: auto;
        }

        .test-result.success {
            background: #e6fffa;
            border: 1px solid #81e6d9;
            color: #234e52;
        }

        .test-result.error {
            background: #fff5f5;
            border: 1px solid #feb2b2;
            color: #742a2a;
        }

        .test-result.info {
            background: #e6f7ff;
            border: 1px solid #91d5ff;
            color: #003a8c;
        }

        .progress-container {
            margin-top: 15px;
        }

        .progress-bar {
            background: #e2e8f0;
            height: 20px;
            border-radius: 10px;
            overflow: hidden;
            position: relative;
        }

        .progress-fill {
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            height: 100%;
            transition: width 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 12px;
            font-weight: bold;
        }

        .model-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            background: #f7fafc;
            border-radius: 5px;
            margin-bottom: 10px;
        }

        .model-size {
            color: #718096;
            font-size: 14px;
        }

        .status-indicator {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
        }

        .status-indicator.ready {
            background: #c6f6d5;
            color: #22543d;
        }

        .status-indicator.loading {
            background: #fefcbf;
            color: #744210;
        }

        .status-indicator.error {
            background: #fed7d7;
            color: #742a2a;
        }

        .file-upload-area {
            border: 2px dashed #cbd5e0;
            border-radius: 8px;
            padding: 30px;
            text-align: center;
            margin-bottom: 20px;
            transition: border-color 0.3s;
        }

        .file-upload-area:hover {
            border-color: #667eea;
        }

        .file-upload-area.drag-over {
            background: #edf2f7;
            border-color: #667eea;
        }

        .test-summary {
            background: #f7fafc;
            border-left: 4px solid #667eea;
            padding: 20px;
            margin-top: 30px;
        }

        .test-summary h3 {
            margin-bottom: 15px;
            color: #2d3748;
        }

        .summary-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #e2e8f0;
        }

        .summary-item:last-child {
            border-bottom: none;
        }

        .metric-value {
            font-weight: bold;
            color: #4a5568;
        }

        @media (max-width: 768px) {
            .test-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="test-container">
        <div class="test-header">
            <h1>ğŸš€ ç”Ÿç”¢ç’°å¢ƒ WASM æ¸¬è©¦</h1>
            <p>æ¸¬è©¦ Whisper æœ¬åœ°è½‰è­¯åŠŸèƒ½çš„å®Œæ•´æµç¨‹</p>
        </div>

        <!-- ç’°å¢ƒæª¢æŸ¥ -->
        <div class="test-section">
            <h2>ğŸ” ç’°å¢ƒæª¢æŸ¥</h2>
            <div class="test-grid">
                <div class="test-card">
                    <h3>ç€è¦½å™¨ç›¸å®¹æ€§</h3>
                    <div id="browser-check" class="test-result info">æª¢æŸ¥ä¸­...</div>
                </div>
                <div class="test-card">
                    <h3>WebAssembly æ”¯æ´</h3>
                    <div id="wasm-check" class="test-result info">æª¢æŸ¥ä¸­...</div>
                </div>
                <div class="test-card">
                    <h3>è¨˜æ†¶é«”ç‹€æ³</h3>
                    <div id="memory-check" class="test-result info">æª¢æŸ¥ä¸­...</div>
                </div>
                <div class="test-card">
                    <h3>ç¶²è·¯é€£æ¥</h3>
                    <div id="network-check" class="test-result info">æª¢æŸ¥ä¸­...</div>
                </div>
            </div>
        </div>

        <!-- æ¨¡å‹æ¸¬è©¦ -->
        <div class="test-section">
            <h2>ğŸ“¦ æ¨¡å‹è¼‰å…¥æ¸¬è©¦</h2>
            <div class="test-grid">
                <div class="test-card">
                    <h3>Tiny æ¨¡å‹</h3>
                    <div class="model-info">
                        <span>æœ€å¿«é€Ÿåº¦</span>
                        <span class="model-size">~39MB</span>
                    </div>
                    <button class="test-button" onclick="testModel('tiny')">è¼‰å…¥æ¸¬è©¦</button>
                    <span id="tiny-status" class="status-indicator">æœªæ¸¬è©¦</span>
                    <div id="tiny-result" class="test-result" style="display: none;"></div>
                    <div id="tiny-progress" class="progress-container" style="display: none;">
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 0%">0%</div>
                        </div>
                    </div>
                </div>

                <div class="test-card">
                    <h3>Base æ¨¡å‹</h3>
                    <div class="model-info">
                        <span>å¹³è¡¡é¸æ“‡</span>
                        <span class="model-size">~74MB</span>
                    </div>
                    <button class="test-button" onclick="testModel('base')">è¼‰å…¥æ¸¬è©¦</button>
                    <span id="base-status" class="status-indicator">æœªæ¸¬è©¦</span>
                    <div id="base-result" class="test-result" style="display: none;"></div>
                    <div id="base-progress" class="progress-container" style="display: none;">
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 0%">0%</div>
                        </div>
                    </div>
                </div>

                <div class="test-card">
                    <h3>Small æ¨¡å‹</h3>
                    <div class="model-info">
                        <span>æœ€ä½³å“è³ª</span>
                        <span class="model-size">~244MB</span>
                    </div>
                    <button class="test-button" onclick="testModel('small')">è¼‰å…¥æ¸¬è©¦</button>
                    <span id="small-status" class="status-indicator">æœªæ¸¬è©¦</span>
                    <div id="small-result" class="test-result" style="display: none;"></div>
                    <div id="small-progress" class="progress-container" style="display: none;">
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 0%">0%</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- è½‰è­¯æ¸¬è©¦ -->
        <div class="test-section">
            <h2>ğŸ™ï¸ è½‰è­¯åŠŸèƒ½æ¸¬è©¦</h2>
            
            <div class="file-upload-area" id="upload-area">
                <p>æ‹–æ›³éŸ³è¨Šæª”æ¡ˆåˆ°é€™è£¡ï¼Œæˆ–é»æ“Šé¸æ“‡æª”æ¡ˆ</p>
                <input type="file" id="audio-file" accept="audio/*" style="display: none;">
                <button class="test-button" onclick="document.getElementById('audio-file').click()">é¸æ“‡æª”æ¡ˆ</button>
            </div>

            <div id="file-info" style="display: none; margin-bottom: 20px;">
                <h4>æª”æ¡ˆè³‡è¨Š</h4>
                <div class="model-info">
                    <span id="file-name">æª”æ¡ˆåç¨±</span>
                    <span id="file-size" class="model-size">å¤§å°</span>
                </div>
            </div>

            <div style="margin-bottom: 20px;">
                <label for="model-select">é¸æ“‡æ¨¡å‹ï¼š</label>
                <select id="model-select" style="padding: 5px 10px; border-radius: 5px; border: 1px solid #cbd5e0;">
                    <option value="tiny">Tiny (å¿«é€Ÿ)</option>
                    <option value="base" selected>Base (æ¨è–¦)</option>
                    <option value="small">Small (é«˜å“è³ª)</option>
                </select>
            </div>

            <button class="test-button" id="transcribe-btn" onclick="testTranscription()" disabled>
                é–‹å§‹è½‰è­¯æ¸¬è©¦
            </button>

            <div id="transcription-progress" class="progress-container" style="display: none;">
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 0%">0%</div>
                </div>
            </div>

            <div id="transcription-result" class="test-result" style="display: none;"></div>
        </div>

        <!-- æ•ˆèƒ½æ¸¬è©¦ -->
        <div class="test-section">
            <h2>âš¡ æ•ˆèƒ½æ¸¬è©¦</h2>
            <button class="test-button" onclick="runPerformanceTest()">åŸ·è¡Œæ•ˆèƒ½æ¸¬è©¦</button>
            <div id="performance-result" class="test-result" style="display: none;"></div>
        </div>

        <!-- æ¸¬è©¦ç¸½çµ -->
        <div class="test-summary" id="test-summary" style="display: none;">
            <h3>ğŸ“Š æ¸¬è©¦ç¸½çµ</h3>
            <div class="summary-item">
                <span>ç’°å¢ƒæª¢æŸ¥</span>
                <span class="metric-value" id="env-summary">-</span>
            </div>
            <div class="summary-item">
                <span>æ¨¡å‹è¼‰å…¥</span>
                <span class="metric-value" id="model-summary">-</span>
            </div>
            <div class="summary-item">
                <span>è½‰è­¯æ¸¬è©¦</span>
                <span class="metric-value" id="transcription-summary">-</span>
            </div>
            <div class="summary-item">
                <span>æ•ˆèƒ½è©•åˆ†</span>
                <span class="metric-value" id="performance-summary">-</span>
            </div>
        </div>
    </div>

    <script type="module">
        import { WhisperWASMManager } from '../js/wasm/whisper-wasm-manager.js';

        let wasmManager = null;
        let selectedFile = null;
        const testResults = {
            environment: {},
            models: {},
            transcription: null,
            performance: null
        };

        // ç’°å¢ƒæª¢æŸ¥
        async function checkEnvironment() {
            // ç€è¦½å™¨æª¢æŸ¥
            const browserCheck = document.getElementById('browser-check');
            const userAgent = navigator.userAgent;
            const isChrome = /Chrome/.test(userAgent) && /Google Inc/.test(navigator.vendor);
            const isFirefox = /Firefox/.test(userAgent);
            const isSafari = /Safari/.test(userAgent) && /Apple Computer/.test(navigator.vendor);
            
            if (isChrome || isFirefox || isSafari) {
                browserCheck.className = 'test-result success';
                browserCheck.textContent = `âœ“ æ”¯æ´çš„ç€è¦½å™¨: ${isChrome ? 'Chrome' : isFirefox ? 'Firefox' : 'Safari'}`;
                testResults.environment.browser = true;
            } else {
                browserCheck.className = 'test-result error';
                browserCheck.textContent = 'âœ— ä¸æ”¯æ´çš„ç€è¦½å™¨ï¼Œè«‹ä½¿ç”¨ Chromeã€Firefox æˆ– Safari';
                testResults.environment.browser = false;
            }

            // WebAssembly æª¢æŸ¥
            const wasmCheck = document.getElementById('wasm-check');
            if (typeof WebAssembly === 'object') {
                wasmCheck.className = 'test-result success';
                wasmCheck.textContent = 'âœ“ WebAssembly æ”¯æ´æ­£å¸¸';
                testResults.environment.wasm = true;
            } else {
                wasmCheck.className = 'test-result error';
                wasmCheck.textContent = 'âœ— WebAssembly ä¸æ”¯æ´';
                testResults.environment.wasm = false;
            }

            // è¨˜æ†¶é«”æª¢æŸ¥
            const memoryCheck = document.getElementById('memory-check');
            if (performance.memory) {
                const totalMemory = performance.memory.jsHeapSizeLimit / (1024 * 1024);
                const usedMemory = performance.memory.usedJSHeapSize / (1024 * 1024);
                const availableMemory = totalMemory - usedMemory;
                
                memoryCheck.className = availableMemory > 500 ? 'test-result success' : 'test-result error';
                memoryCheck.textContent = `${availableMemory > 500 ? 'âœ“' : 'âœ—'} å¯ç”¨è¨˜æ†¶é«”: ${Math.round(availableMemory)}MB / ${Math.round(totalMemory)}MB`;
                testResults.environment.memory = availableMemory > 500;
            } else {
                memoryCheck.className = 'test-result info';
                memoryCheck.textContent = 'âš ï¸ ç„¡æ³•æª¢æ¸¬è¨˜æ†¶é«”ç‹€æ³ï¼ˆé Chrome ç€è¦½å™¨ï¼‰';
                testResults.environment.memory = true; // å‡è¨­æ­£å¸¸
            }

            // ç¶²è·¯æª¢æŸ¥
            const networkCheck = document.getElementById('network-check');
            try {
                const response = await fetch('https://cdn.jsdelivr.net/npm/@xenova/transformers@2.6.0', { method: 'HEAD' });
                if (response.ok) {
                    networkCheck.className = 'test-result success';
                    networkCheck.textContent = 'âœ“ ç¶²è·¯é€£æ¥æ­£å¸¸ï¼ŒCDN å¯å­˜å–';
                    testResults.environment.network = true;
                } else {
                    throw new Error('CDN ç„¡æ³•å­˜å–');
                }
            } catch (error) {
                networkCheck.className = 'test-result error';
                networkCheck.textContent = 'âœ— ç¶²è·¯é€£æ¥å•é¡Œï¼Œç„¡æ³•å­˜å– CDN';
                testResults.environment.network = false;
            }

            updateSummary();
        }

        // æ¸¬è©¦æ¨¡å‹è¼‰å…¥
        window.testModel = async function(modelName) {
            const button = event.target;
            const statusEl = document.getElementById(`${modelName}-status`);
            const resultEl = document.getElementById(`${modelName}-result`);
            const progressEl = document.getElementById(`${modelName}-progress`);
            const progressFill = progressEl.querySelector('.progress-fill');

            button.disabled = true;
            statusEl.className = 'status-indicator loading';
            statusEl.textContent = 'è¼‰å…¥ä¸­...';
            resultEl.style.display = 'none';
            progressEl.style.display = 'block';

            const startTime = Date.now();

            try {
                if (!wasmManager) {
                    wasmManager = new WhisperWASMManager();
                }

                // è¨­å®šé€²åº¦å›èª¿
                let lastProgress = 0;
                const updateProgress = (progress) => {
                    if (progress.percentage) {
                        lastProgress = progress.percentage;
                        progressFill.style.width = `${progress.percentage}%`;
                        progressFill.textContent = `${Math.round(progress.percentage)}%`;
                    }
                    if (progress.message) {
                        resultEl.style.display = 'block';
                        resultEl.className = 'test-result info';
                        resultEl.textContent = progress.message;
                    }
                };

                // æª¢æŸ¥å¿«å–
                const isCached = await wasmManager.isModelCached(modelName);
                
                await wasmManager.initialize(modelName);

                const endTime = Date.now();
                const loadTime = (endTime - startTime) / 1000;

                statusEl.className = 'status-indicator ready';
                statusEl.textContent = 'å·²è¼‰å…¥';
                resultEl.className = 'test-result success';
                resultEl.textContent = `âœ“ æ¨¡å‹è¼‰å…¥æˆåŠŸ\nè¼‰å…¥æ™‚é–“: ${loadTime.toFixed(2)} ç§’\nä¾†æº: ${isCached ? 'æœ¬åœ°å¿«å–' : 'CDN ä¸‹è¼‰'}`;
                
                testResults.models[modelName] = {
                    success: true,
                    loadTime: loadTime,
                    cached: isCached
                };

            } catch (error) {
                statusEl.className = 'status-indicator error';
                statusEl.textContent = 'è¼‰å…¥å¤±æ•—';
                resultEl.className = 'test-result error';
                resultEl.textContent = `âœ— è¼‰å…¥å¤±æ•—: ${error.message}`;
                resultEl.style.display = 'block';
                
                testResults.models[modelName] = {
                    success: false,
                    error: error.message
                };
            } finally {
                button.disabled = false;
                progressEl.style.display = 'none';
                updateSummary();
            }
        };

        // æª”æ¡ˆä¸Šå‚³è™•ç†
        const uploadArea = document.getElementById('upload-area');
        const fileInput = document.getElementById('audio-file');

        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadArea.classList.add('drag-over');
        });

        uploadArea.addEventListener('dragleave', () => {
            uploadArea.classList.remove('drag-over');
        });

        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.classList.remove('drag-over');
            
            const files = e.dataTransfer.files;
            if (files.length > 0 && files[0].type.startsWith('audio/')) {
                handleFile(files[0]);
            }
        });

        fileInput.addEventListener('change', (e) => {
            if (e.target.files.length > 0) {
                handleFile(e.target.files[0]);
            }
        });

        function handleFile(file) {
            selectedFile = file;
            document.getElementById('file-info').style.display = 'block';
            document.getElementById('file-name').textContent = file.name;
            document.getElementById('file-size').textContent = `${(file.size / 1024 / 1024).toFixed(2)} MB`;
            document.getElementById('transcribe-btn').disabled = false;
        }

        // æ¸¬è©¦è½‰è­¯
        window.testTranscription = async function() {
            if (!selectedFile) return;

            const button = document.getElementById('transcribe-btn');
            const progressEl = document.getElementById('transcription-progress');
            const progressFill = progressEl.querySelector('.progress-fill');
            const resultEl = document.getElementById('transcription-result');
            const modelSelect = document.getElementById('model-select');
            const selectedModel = modelSelect.value;

            button.disabled = true;
            progressEl.style.display = 'block';
            resultEl.style.display = 'none';

            const startTime = Date.now();

            try {
                if (!wasmManager) {
                    wasmManager = new WhisperWASMManager();
                }

                // åˆå§‹åŒ–æ¨¡å‹
                await wasmManager.initialize(selectedModel);

                // åŸ·è¡Œè½‰è­¯
                const result = await wasmManager.transcribe(selectedFile, {
                    onProgress: (progress) => {
                        if (progress.percentage) {
                            progressFill.style.width = `${progress.percentage}%`;
                            progressFill.textContent = `${Math.round(progress.percentage)}%`;
                        }
                    }
                });

                const endTime = Date.now();
                const processTime = (endTime - startTime) / 1000;

                resultEl.className = 'test-result success';
                resultEl.style.display = 'block';
                resultEl.textContent = `âœ“ è½‰è­¯æˆåŠŸï¼
è™•ç†æ™‚é–“: ${processTime.toFixed(2)} ç§’
éŸ³è¨Šé•·åº¦: ${result.duration ? result.duration.toFixed(2) : 'æœªçŸ¥'} ç§’
èªè¨€: ${result.language || 'è‡ªå‹•æª¢æ¸¬'}
è½‰è­¯æ–¹å¼: ${result.method || 'WASM'}

è½‰è­¯æ–‡å­—:
${result.text}

æ®µè½æ•¸: ${result.segments ? result.segments.length : 0}`;

                testResults.transcription = {
                    success: true,
                    processTime: processTime,
                    duration: result.duration,
                    model: selectedModel
                };

            } catch (error) {
                resultEl.className = 'test-result error';
                resultEl.style.display = 'block';
                resultEl.textContent = `âœ— è½‰è­¯å¤±æ•—: ${error.message}`;
                
                testResults.transcription = {
                    success: false,
                    error: error.message
                };
            } finally {
                button.disabled = false;
                progressEl.style.display = 'none';
                updateSummary();
            }
        };

        // æ•ˆèƒ½æ¸¬è©¦
        window.runPerformanceTest = async function() {
            const button = event.target;
            const resultEl = document.getElementById('performance-result');
            
            button.disabled = true;
            resultEl.style.display = 'block';
            resultEl.className = 'test-result info';
            resultEl.textContent = 'åŸ·è¡Œæ•ˆèƒ½æ¸¬è©¦ä¸­...';

            try {
                const tests = [];
                
                // æ¸¬è©¦ 1: æ¨¡å‹å¿«å–æª¢æŸ¥é€Ÿåº¦
                const cacheStart = performance.now();
                if (wasmManager) {
                    await wasmManager.isModelCached('tiny');
                }
                const cacheTime = performance.now() - cacheStart;
                tests.push(`å¿«å–æª¢æŸ¥: ${cacheTime.toFixed(2)}ms`);

                // æ¸¬è©¦ 2: Audio Context å‰µå»ºé€Ÿåº¦
                const audioStart = performance.now();
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                audioContext.close();
                const audioTime = performance.now() - audioStart;
                tests.push(`Audio Context: ${audioTime.toFixed(2)}ms`);

                // æ¸¬è©¦ 3: Worker å‰µå»ºé€Ÿåº¦
                const workerStart = performance.now();
                const testWorker = new Worker('data:text/javascript,self.postMessage("test")');
                await new Promise(resolve => {
                    testWorker.onmessage = resolve;
                });
                testWorker.terminate();
                const workerTime = performance.now() - workerStart;
                tests.push(`Worker å‰µå»º: ${workerTime.toFixed(2)}ms`);

                // è¨ˆç®—ç¸½åˆ†
                const totalTime = cacheTime + audioTime + workerTime;
                let score = 'å„ªç§€';
                if (totalTime > 100) score = 'è‰¯å¥½';
                if (totalTime > 200) score = 'ä¸€èˆ¬';
                if (totalTime > 500) score = 'è¼ƒå·®';

                resultEl.className = 'test-result success';
                resultEl.textContent = `âœ“ æ•ˆèƒ½æ¸¬è©¦å®Œæˆ

${tests.join('\n')}

ç¸½è€—æ™‚: ${totalTime.toFixed(2)}ms
æ•ˆèƒ½è©•åˆ†: ${score}`;

                testResults.performance = {
                    score: score,
                    totalTime: totalTime
                };

            } catch (error) {
                resultEl.className = 'test-result error';
                resultEl.textContent = `âœ— æ•ˆèƒ½æ¸¬è©¦å¤±æ•—: ${error.message}`;
                
                testResults.performance = {
                    score: 'éŒ¯èª¤',
                    error: error.message
                };
            } finally {
                button.disabled = false;
                updateSummary();
            }
        };

        // æ›´æ–°æ¸¬è©¦ç¸½çµ
        function updateSummary() {
            const summary = document.getElementById('test-summary');
            summary.style.display = 'block';

            // ç’°å¢ƒç¸½çµ
            const envCount = Object.values(testResults.environment).filter(v => v === true).length;
            const envTotal = Object.keys(testResults.environment).length;
            document.getElementById('env-summary').textContent = `${envCount}/${envTotal} é€šé`;

            // æ¨¡å‹ç¸½çµ
            const modelCount = Object.values(testResults.models).filter(v => v.success).length;
            const modelTotal = Object.keys(testResults.models).length;
            document.getElementById('model-summary').textContent = modelTotal > 0 ? `${modelCount}/${modelTotal} æˆåŠŸ` : 'æœªæ¸¬è©¦';

            // è½‰è­¯ç¸½çµ
            if (testResults.transcription) {
                document.getElementById('transcription-summary').textContent = 
                    testResults.transcription.success ? 'æˆåŠŸ' : 'å¤±æ•—';
            } else {
                document.getElementById('transcription-summary').textContent = 'æœªæ¸¬è©¦';
            }

            // æ•ˆèƒ½ç¸½çµ
            if (testResults.performance) {
                document.getElementById('performance-summary').textContent = 
                    testResults.performance.score || 'æœªçŸ¥';
            } else {
                document.getElementById('performance-summary').textContent = 'æœªæ¸¬è©¦';
            }
        }

        // åˆå§‹åŒ–
        checkEnvironment();
    </script>
</body>
</html>