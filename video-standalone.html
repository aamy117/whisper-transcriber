<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ë¶ñË®äÊí≠ÊîæÂô® - Whisper Â∑•ÂÖ∑</title>
    <link rel="stylesheet" href="css/shared.css">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/video.css">
</head>
<body>
    <!-- Â∞éËà™Âàó -->
    <nav class="app-navigation">
        <div class="nav-container">
            <div class="nav-brand">
                <h1 class="nav-title">Whisper Â∑•ÂÖ∑</h1>
            </div>
            <div class="nav-links">
                <a href="index.html" class="nav-link">
                    <span class="nav-icon">üéµ</span>
                    <span>Èü≥Ë®äÂ∑•ÂÖ∑</span>
                </a>
                <a href="video-standalone.html" class="nav-link active">
                    <span class="nav-icon">üé¨</span>
                    <span>Ë¶ñË®äÂ∑•ÂÖ∑</span>
                </a>
            </div>
        </div>
    </nav>

    <div id="video-app">
        <header class="app-header">
            <div class="container">
                <h1 class="app-title">Ë¶ñË®äÊí≠ÊîæÂô®</h1>
                <nav class="app-nav">
                    <button class="nav-btn" id="themeToggleBtn" title="ÂàáÊèõÊ∑±Ëâ≤/Ê∑∫Ëâ≤Ê®°Âºè">
                        <span class="icon icon-light">üåû</span>
                        <span class="icon icon-dark">üåô</span>
                    </button>
                </nav>
            </div>
        </header>

        <main class="video-main">
            <div class="video-layout">
                <!-- Â∑¶ÂÅ¥ÔºöË¶ñË®äÊí≠ÊîæÂçÄ -->
                <section class="video-section">
                    <!-- ‰∏äÂÇ≥ÂçÄÂüü -->
                    <div class="video-upload-area" id="videoUploadArea">
                        <div class="upload-content">
                            <span class="upload-icon">üé¨</span>
                            <h2>‰∏äÂÇ≥ÂΩ±ÁâáÊ™îÊ°à</h2>
                            <p>ÊãñÊîæÊ™îÊ°àÂà∞Ê≠§ËôïÔºåÊàñÈªûÊìäÈÅ∏ÊìáÊ™îÊ°à</p>
                            <p class="upload-hint">ÊîØÊè¥Ê†ºÂºèÔºöMP4„ÄÅWebM„ÄÅOGVÔºàÊúÄÂ§ß 2GBÔºâ</p>
                            <input type="file" id="videoInput" accept="video/*" hidden>
                            <button class="btn btn-primary" id="selectVideoBtn">ÈÅ∏ÊìáÊ™îÊ°à</button>
                        </div>
                    </div>

                    <!-- Ë¶ñË®äÊí≠ÊîæÂô®ÂÆπÂô® -->
                    <div class="video-player-container hidden" id="videoPlayerContainer">
                        <div class="video-wrapper" id="videoWrapper">
                            <!-- Ë¶ñË®äÂÖÉÁ¥† -->
                            <video id="videoPlayer" preload="metadata"></video>
                            
                            <!-- ËºâÂÖ•ÊåáÁ§∫Âô® -->
                            <div class="video-loading hidden" id="videoLoading">
                                <div class="loading-spinner"></div>
                                <p class="loading-text">ËºâÂÖ•‰∏≠...</p>
                            </div>
                            
                            <!-- Ëá™ÂÆöÁæ©ÊéßÂà∂Âàó -->
                            <div class="video-controls" id="videoControls">
                                <!-- ÈÄ≤Â∫¶Ê¢ùÂçÄÂüü -->
                                <div class="controls-progress-area">
                                    <div class="progress-container" id="progressContainer">
                                        <div class="progress-buffered" id="progressBuffered"></div>
                                        <div class="progress-played" id="progressPlayed"></div>
                                        <div class="progress-thumb" id="progressThumb"></div>
                                        <input type="range" id="progressSlider" class="progress-slider" value="0" min="0" max="100" step="0.1">
                                    </div>
                                    <div class="time-display">
                                        <span id="currentTime">00:00</span>
                                        <span class="time-separator">/</span>
                                        <span id="totalTime">00:00</span>
                                    </div>
                                </div>
                                
                                <!-- ÊéßÂà∂ÊåâÈàïÂçÄÂüü -->
                                <div class="controls-buttons">
                                    <!-- Â∑¶ÂÅ¥ÊéßÂà∂ -->
                                    <div class="controls-left">
                                        <button class="control-btn" id="playPauseBtn" title="Êí≠Êîæ/Êö´ÂÅú (Á©∫ÁôΩÈçµ)">
                                            <svg class="icon icon-play" viewBox="0 0 24 24" fill="currentColor">
                                                <path d="M8 5v14l11-7z"/>
                                            </svg>
                                            <svg class="icon icon-pause hidden" viewBox="0 0 24 24" fill="currentColor">
                                                <path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/>
                                            </svg>
                                        </button>
                                        
                                        <button class="control-btn" id="skipBackBtn" title="Âø´ÈÄÄ 5 Áßí (‚Üê)">
                                            <svg class="icon" viewBox="0 0 24 24" fill="currentColor">
                                                <path d="M11 18V6l-8.5 6 8.5 6zm.5-6l8.5 6V6l-8.5 6z"/>
                                            </svg>
                                        </button>
                                        
                                        <button class="control-btn" id="skipForwardBtn" title="Âø´ÈÄ≤ 5 Áßí (‚Üí)">
                                            <svg class="icon" viewBox="0 0 24 24" fill="currentColor">
                                                <path d="M4 18l8.5-6L4 6v12zm9-12v12l8.5-6L13 6z"/>
                                            </svg>
                                        </button>
                                        
                                        <!-- Èü≥ÈáèÊéßÂà∂ -->
                                        <div class="volume-control">
                                            <button class="control-btn" id="muteBtn" title="ÈùúÈü≥ (M)">
                                                <svg class="icon icon-volume" viewBox="0 0 24 24" fill="currentColor">
                                                    <path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"/>
                                                </svg>
                                                <svg class="icon icon-mute hidden" viewBox="0 0 24 24" fill="currentColor">
                                                    <path d="M16.5 12c0-1.77-1.02-3.29-2.5-4.03v2.21l2.45 2.45c.03-.2.05-.41.05-.63zm2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51C20.63 14.91 21 13.5 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zM4.27 3L3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06c1.38-.31 2.63-.95 3.69-1.81L19.73 21 21 19.73l-9-9L4.27 3zM12 4L9.91 6.09 12 8.18V4z"/>
                                                </svg>
                                            </button>
                                            <input type="range" id="volumeSlider" class="volume-slider" value="100" min="0" max="100" title="Èü≥Èáè">
                                        </div>
                                    </div>
                                    
                                    <!-- Âè≥ÂÅ¥ÊéßÂà∂ -->
                                    <div class="controls-right">
                                        <!-- Êí≠ÊîæÈÄüÂ∫¶ -->
                                        <div class="speed-control">
                                            <button class="control-btn" id="speedBtn" title="Êí≠ÊîæÈÄüÂ∫¶">
                                                <span class="speed-text">1x</span>
                                            </button>
                                            <div class="speed-menu hidden" id="speedMenu">
                                                <button class="speed-option" data-speed="0.5">0.5x</button>
                                                <button class="speed-option" data-speed="0.75">0.75x</button>
                                                <button class="speed-option active" data-speed="1">1x</button>
                                                <button class="speed-option" data-speed="1.25">1.25x</button>
                                                <button class="speed-option" data-speed="1.5">1.5x</button>
                                                <button class="speed-option" data-speed="2">2x</button>
                                            </div>
                                        </div>
                                        
                                        <!-- ÂÖ®Ëû¢Âπï -->
                                        <button class="control-btn" id="fullscreenBtn" title="ÂÖ®Ëû¢Âπï (F)">
                                            <svg class="icon icon-expand" viewBox="0 0 24 24" fill="currentColor">
                                                <path d="M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"/>
                                            </svg>
                                            <svg class="icon icon-compress hidden" viewBox="0 0 24 24" fill="currentColor">
                                                <path d="M5 16h3v3h2v-5H5v2zm3-8H5v2h5V5H8v3zm6 11h2v-3h3v-2h-5v5zm2-11V5h-2v5h5V8h-3z"/>
                                            </svg>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Âè≥ÂÅ¥ÔºöÂäüËÉΩÈù¢Êùø -->
                <aside class="side-panel">
                    <!-- Ê®ôÁ±§ÂàáÊèõ -->
                    <div class="panel-tabs">
                        <button class="tab-btn active" data-tab="info">ÂΩ±ÁâáË≥áË®ä</button>
                        <button class="tab-btn" data-tab="placeholder">ÂäüËÉΩÈñãÁôº‰∏≠</button>
                    </div>

                    <!-- Ë≥áË®äÈù¢Êùø -->
                    <div class="panel-content active" id="infoPanel">
                        <div class="video-info">
                            <h3>ÂΩ±ÁâáË≥áË®ä</h3>
                            <div class="info-item">
                                <span class="info-label">Ê™îÊ°àÂêçÁ®±Ôºö</span>
                                <span class="info-value" id="videoFileName">-</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Ê™îÊ°àÂ§ßÂ∞èÔºö</span>
                                <span class="info-value" id="videoFileSize">-</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">ÂΩ±ÁâáÈï∑Â∫¶Ôºö</span>
                                <span class="info-value" id="videoDuration">-</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Ëß£ÊûêÂ∫¶Ôºö</span>
                                <span class="info-value" id="videoResolution">-</span>
                            </div>
                        </div>
                    </div>

                    <!-- ‰Ωî‰ΩçÈù¢Êùø -->
                    <div class="panel-content hidden" id="placeholderPanel">
                        <p class="panel-placeholder">ÂäüËÉΩÈñãÁôº‰∏≠...</p>
                    </div>
                </aside>
            </div>
        </main>
    </div>

    <!-- ÂÆåÊï¥ÂäüËÉΩÁöÑ JavaScriptÔºà‰∏ç‰ΩøÁî®Ê®°ÁµÑÔºâ -->
    <script>
    (function() {
        'use strict';
        
        // Ë¶ñË®äÊí≠ÊîæÂô®ÊáâÁî®Á®ãÂºè
        class VideoApp {
            constructor() {
                this.video = null;
                this.isPlaying = false;
                this.isSeeking = false;
                this.currentFile = null;
                this.controlsTimer = null;
                
                // DOM ÂÖÉÁ¥†
                this.elements = {};
                
                this.init();
            }
            
            init() {
                console.log('ÂàùÂßãÂåñË¶ñË®äÊí≠ÊîæÂô®...');
                
                // Á≠âÂæÖ DOM ËºâÂÖ•
                if (document.readyState === 'loading') {
                    document.addEventListener('DOMContentLoaded', () => this.setup());
                } else {
                    this.setup();
                }
            }
            
            setup() {
                this.cacheElements();
                this.bindEvents();
                this.setupTheme();
                console.log('Ë¶ñË®äÊí≠ÊîæÂô®ÂàùÂßãÂåñÂÆåÊàê');
            }
            
            cacheElements() {
                // Âø´ÂèñÊâÄÊúâÈúÄË¶ÅÁöÑ DOM ÂÖÉÁ¥†
                this.elements = {
                    // Ê™îÊ°àËº∏ÂÖ•
                    fileInput: document.getElementById('videoInput'),
                    selectBtn: document.getElementById('selectVideoBtn'),
                    uploadArea: document.getElementById('videoUploadArea'),
                    
                    // Êí≠ÊîæÂô®
                    video: document.getElementById('videoPlayer'),
                    playerContainer: document.getElementById('videoPlayerContainer'),
                    wrapper: document.getElementById('videoWrapper'),
                    controls: document.getElementById('videoControls'),
                    loading: document.getElementById('videoLoading'),
                    
                    // Êí≠ÊîæÊéßÂà∂
                    playPauseBtn: document.getElementById('playPauseBtn'),
                    skipBackBtn: document.getElementById('skipBackBtn'),
                    skipForwardBtn: document.getElementById('skipForwardBtn'),
                    
                    // ÈÄ≤Â∫¶Ê¢ù
                    progressContainer: document.getElementById('progressContainer'),
                    progressSlider: document.getElementById('progressSlider'),
                    progressPlayed: document.getElementById('progressPlayed'),
                    progressBuffered: document.getElementById('progressBuffered'),
                    progressThumb: document.getElementById('progressThumb'),
                    
                    // ÊôÇÈñì
                    currentTime: document.getElementById('currentTime'),
                    totalTime: document.getElementById('totalTime'),
                    
                    // Èü≥Èáè
                    muteBtn: document.getElementById('muteBtn'),
                    volumeSlider: document.getElementById('volumeSlider'),
                    
                    // ÈÄüÂ∫¶
                    speedBtn: document.getElementById('speedBtn'),
                    speedMenu: document.getElementById('speedMenu'),
                    speedText: document.querySelector('.speed-text'),
                    
                    // ÂÖ®Ëû¢Âπï
                    fullscreenBtn: document.getElementById('fullscreenBtn'),
                    
                    // Ë≥áË®ä
                    videoFileName: document.getElementById('videoFileName'),
                    videoFileSize: document.getElementById('videoFileSize'),
                    videoDuration: document.getElementById('videoDuration'),
                    videoResolution: document.getElementById('videoResolution'),
                    
                    // ‰∏ªÈ°å
                    themeToggleBtn: document.getElementById('themeToggleBtn')
                };
                
                this.video = this.elements.video;
            }
            
            bindEvents() {
                // Ê™îÊ°àÈÅ∏Êìá
                this.elements.selectBtn.addEventListener('click', () => {
                    this.elements.fileInput.click();
                });
                
                this.elements.fileInput.addEventListener('change', (e) => {
                    this.handleFileSelect(e.target.files);
                });
                
                // ÊãñÊîæ
                this.setupDragDrop();
                
                // Êí≠ÊîæÊéßÂà∂
                this.setupPlaybackControls();
                
                // ÈÄ≤Â∫¶Ê¢ù
                this.setupProgressControls();
                
                // Èü≥ÈáèÊéßÂà∂
                this.setupVolumeControls();
                
                // ÈÄüÂ∫¶ÊéßÂà∂
                this.setupSpeedControls();
                
                // ÂÖ®Ëû¢Âπï
                this.elements.fullscreenBtn.addEventListener('click', () => {
                    this.toggleFullscreen();
                });
                
                // Ë¶ñË®ä‰∫ã‰ª∂
                this.setupVideoEvents();
                
                // ÈçµÁõ§Âø´Êç∑Èçµ
                this.setupKeyboardShortcuts();
                
                // ÊéßÂà∂ÂàóËá™ÂãïÈö±Ëóè
                this.setupControlsVisibility();
                
                // ‰∏ªÈ°åÂàáÊèõ
                if (this.elements.themeToggleBtn) {
                    this.elements.themeToggleBtn.addEventListener('click', () => {
                        this.toggleTheme();
                    });
                }
                
                // Ê®ôÁ±§ÂàáÊèõ
                document.querySelectorAll('.tab-btn').forEach(btn => {
                    btn.addEventListener('click', () => this.switchTab(btn.dataset.tab));
                });
            }
            
            setupDragDrop() {
                const area = this.elements.uploadArea;
                
                area.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    area.classList.add('drag-over');
                });
                
                area.addEventListener('dragleave', () => {
                    area.classList.remove('drag-over');
                });
                
                area.addEventListener('drop', (e) => {
                    e.preventDefault();
                    area.classList.remove('drag-over');
                    this.handleFileSelect(e.dataTransfer.files);
                });
            }
            
            setupPlaybackControls() {
                this.elements.playPauseBtn.addEventListener('click', () => {
                    this.togglePlayPause();
                });
                
                this.elements.skipBackBtn.addEventListener('click', () => {
                    this.skip(-5);
                });
                
                this.elements.skipForwardBtn.addEventListener('click', () => {
                    this.skip(5);
                });
                
                this.video.addEventListener('click', () => {
                    this.togglePlayPause();
                });
            }
            
            setupProgressControls() {
                this.elements.progressSlider.addEventListener('input', (e) => {
                    this.isSeeking = true;
                    const percent = parseFloat(e.target.value);
                    this.updateProgressUI(percent);
                });
                
                this.elements.progressSlider.addEventListener('change', (e) => {
                    const percent = parseFloat(e.target.value);
                    const time = (percent / 100) * this.video.duration;
                    this.video.currentTime = time;
                    this.isSeeking = false;
                });
                
                this.elements.progressContainer.addEventListener('click', (e) => {
                    const rect = this.elements.progressContainer.getBoundingClientRect();
                    const percent = ((e.clientX - rect.left) / rect.width) * 100;
                    const time = (percent / 100) * this.video.duration;
                    this.video.currentTime = time;
                });
            }
            
            setupVolumeControls() {
                this.elements.muteBtn.addEventListener('click', () => {
                    this.video.muted = !this.video.muted;
                    this.updateVolumeUI();
                });
                
                this.elements.volumeSlider.addEventListener('input', (e) => {
                    this.video.volume = e.target.value / 100;
                    this.updateVolumeUI();
                });
            }
            
            setupSpeedControls() {
                this.elements.speedBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    this.elements.speedMenu.classList.toggle('hidden');
                });
                
                document.querySelectorAll('.speed-option').forEach(option => {
                    option.addEventListener('click', (e) => {
                        const speed = parseFloat(e.target.dataset.speed);
                        this.video.playbackRate = speed;
                        this.updateSpeedUI(speed);
                        this.elements.speedMenu.classList.add('hidden');
                    });
                });
                
                document.addEventListener('click', () => {
                    this.elements.speedMenu.classList.add('hidden');
                });
            }
            
            setupVideoEvents() {
                this.video.addEventListener('loadstart', () => {
                    this.showLoading();
                });
                
                this.video.addEventListener('loadedmetadata', () => {
                    this.hideLoading();
                    this.updateVideoInfo();
                });
                
                this.video.addEventListener('play', () => {
                    this.isPlaying = true;
                    this.updatePlayPauseButton();
                    this.startControlsTimer();
                });
                
                this.video.addEventListener('pause', () => {
                    this.isPlaying = false;
                    this.updatePlayPauseButton();
                    this.showControls();
                });
                
                this.video.addEventListener('timeupdate', () => {
                    if (!this.isSeeking) {
                        this.updateTimeDisplay();
                        this.updateProgress();
                    }
                });
                
                this.video.addEventListener('progress', () => {
                    this.updateBuffered();
                });
                
                this.video.addEventListener('volumechange', () => {
                    this.updateVolumeUI();
                });
                
                this.video.addEventListener('error', (e) => {
                    console.error('Ë¶ñË®äÈåØË™§:', e);
                    this.hideLoading();
                    alert('Ë¶ñË®äËºâÂÖ•Â§±Êïó');
                });
            }
            
            setupKeyboardShortcuts() {
                document.addEventListener('keydown', (e) => {
                    if (e.target.tagName === 'INPUT') return;
                    
                    switch(e.code) {
                        case 'Space':
                            e.preventDefault();
                            this.togglePlayPause();
                            break;
                        case 'ArrowLeft':
                            e.preventDefault();
                            this.skip(-5);
                            break;
                        case 'ArrowRight':
                            e.preventDefault();
                            this.skip(5);
                            break;
                        case 'ArrowUp':
                            e.preventDefault();
                            this.adjustVolume(0.1);
                            break;
                        case 'ArrowDown':
                            e.preventDefault();
                            this.adjustVolume(-0.1);
                            break;
                        case 'KeyF':
                            this.toggleFullscreen();
                            break;
                        case 'KeyM':
                            this.video.muted = !this.video.muted;
                            this.updateVolumeUI();
                            break;
                    }
                });
            }
            
            setupControlsVisibility() {
                this.elements.wrapper.addEventListener('mousemove', () => {
                    this.showControls();
                });
                
                this.elements.wrapper.addEventListener('mouseleave', () => {
                    if (this.isPlaying) {
                        this.startControlsTimer();
                    }
                });
            }
            
            handleFileSelect(files) {
                if (!files || files.length === 0) return;
                
                const file = files[0];
                if (!file.type.startsWith('video/')) {
                    alert('Ë´ãÈÅ∏ÊìáË¶ñË®äÊ™îÊ°à');
                    return;
                }
                
                // Ê™¢Êü•Ê™îÊ°àÂ§ßÂ∞è
                const maxSize = 2 * 1024 * 1024 * 1024; // 2GB
                if (file.size > maxSize) {
                    if (!confirm(`Ê™îÊ°àÂ§ßÂ∞èÁÇ∫ ${this.formatFileSize(file.size)}ÔºåÂèØËÉΩÂΩ±ÈüøÊïàËÉΩ„ÄÇÊòØÂê¶ÁπºÁ∫åÔºü`)) {
                        return;
                    }
                }
                
                // ËºâÂÖ•Ë¶ñË®ä
                this.currentFile = file;
                const url = URL.createObjectURL(file);
                this.video.src = url;
                
                // È°ØÁ§∫Êí≠ÊîæÂô®
                this.elements.uploadArea.classList.add('hidden');
                this.elements.playerContainer.classList.remove('hidden');
                
                // Êõ¥Êñ∞Ê™îÊ°àË≥áË®ä
                this.elements.videoFileName.textContent = file.name;
                this.elements.videoFileSize.textContent = this.formatFileSize(file.size);
            }
            
            togglePlayPause() {
                if (this.video.paused) {
                    this.video.play();
                } else {
                    this.video.pause();
                }
            }
            
            skip(seconds) {
                this.video.currentTime = Math.max(0, Math.min(
                    this.video.currentTime + seconds,
                    this.video.duration
                ));
            }
            
            adjustVolume(delta) {
                this.video.volume = Math.max(0, Math.min(1, this.video.volume + delta));
            }
            
            toggleFullscreen() {
                if (!document.fullscreenElement) {
                    this.elements.wrapper.requestFullscreen().catch(err => {
                        console.error('ÁÑ°Ê≥ïÈÄ≤ÂÖ•ÂÖ®Ëû¢Âπï:', err);
                    });
                } else {
                    document.exitFullscreen();
                }
            }
            
            updatePlayPauseButton() {
                const playIcon = this.elements.playPauseBtn.querySelector('.icon-play');
                const pauseIcon = this.elements.playPauseBtn.querySelector('.icon-pause');
                
                if (this.isPlaying) {
                    playIcon.classList.add('hidden');
                    pauseIcon.classList.remove('hidden');
                } else {
                    playIcon.classList.remove('hidden');
                    pauseIcon.classList.add('hidden');
                }
            }
            
            updateTimeDisplay() {
                this.elements.currentTime.textContent = this.formatTime(this.video.currentTime);
                this.elements.totalTime.textContent = this.formatTime(this.video.duration);
            }
            
            updateProgress() {
                const percent = (this.video.currentTime / this.video.duration) * 100;
                this.updateProgressUI(percent);
            }
            
            updateProgressUI(percent) {
                this.elements.progressSlider.value = percent;
                this.elements.progressPlayed.style.width = percent + '%';
                this.elements.progressThumb.style.left = percent + '%';
            }
            
            updateBuffered() {
                if (this.video.buffered.length > 0) {
                    const bufferedEnd = this.video.buffered.end(this.video.buffered.length - 1);
                    const percent = (bufferedEnd / this.video.duration) * 100;
                    this.elements.progressBuffered.style.width = percent + '%';
                }
            }
            
            updateVolumeUI() {
                const volume = this.video.volume;
                const muted = this.video.muted;
                
                this.elements.volumeSlider.value = volume * 100;
                
                const volumeIcon = this.elements.muteBtn.querySelector('.icon-volume');
                const muteIcon = this.elements.muteBtn.querySelector('.icon-mute');
                
                if (muted || volume === 0) {
                    volumeIcon.classList.add('hidden');
                    muteIcon.classList.remove('hidden');
                } else {
                    volumeIcon.classList.remove('hidden');
                    muteIcon.classList.add('hidden');
                }
            }
            
            updateSpeedUI(speed) {
                this.elements.speedText.textContent = speed + 'x';
                
                document.querySelectorAll('.speed-option').forEach(option => {
                    const optionSpeed = parseFloat(option.dataset.speed);
                    option.classList.toggle('active', optionSpeed === speed);
                });
            }
            
            updateVideoInfo() {
                this.elements.videoDuration.textContent = this.formatTime(this.video.duration);
                this.elements.videoResolution.textContent = 
                    this.video.videoWidth + ' √ó ' + this.video.videoHeight;
            }
            
            showControls() {
                this.elements.controls.classList.add('show');
                if (this.controlsTimer) {
                    clearTimeout(this.controlsTimer);
                    this.controlsTimer = null;
                }
            }
            
            hideControls() {
                this.elements.controls.classList.remove('show');
            }
            
            startControlsTimer() {
                if (this.controlsTimer) {
                    clearTimeout(this.controlsTimer);
                }
                
                this.controlsTimer = setTimeout(() => {
                    if (this.isPlaying) {
                        this.hideControls();
                    }
                }, 3000);
            }
            
            showLoading() {
                this.elements.loading.classList.remove('hidden');
            }
            
            hideLoading() {
                this.elements.loading.classList.add('hidden');
            }
            
            setupTheme() {
                const savedTheme = localStorage.getItem('whisper_theme') || 'light';
                document.documentElement.setAttribute('data-theme', savedTheme);
            }
            
            toggleTheme() {
                const currentTheme = document.documentElement.getAttribute('data-theme') || 'light';
                const newTheme = currentTheme === 'light' ? 'dark' : 'light';
                document.documentElement.setAttribute('data-theme', newTheme);
                localStorage.setItem('whisper_theme', newTheme);
            }
            
            switchTab(tabName) {
                document.querySelectorAll('.tab-btn').forEach(btn => {
                    btn.classList.toggle('active', btn.dataset.tab === tabName);
                });
                
                document.querySelectorAll('.panel-content').forEach(panel => {
                    panel.classList.add('hidden');
                });
                
                const targetPanel = document.getElementById(tabName + 'Panel');
                if (targetPanel) {
                    targetPanel.classList.remove('hidden');
                }
            }
            
            formatTime(seconds) {
                if (isNaN(seconds)) return '00:00';
                
                const hours = Math.floor(seconds / 3600);
                const minutes = Math.floor((seconds % 3600) / 60);
                const secs = Math.floor(seconds % 60);
                
                if (hours > 0) {
                    return hours + ':' + 
                           minutes.toString().padStart(2, '0') + ':' + 
                           secs.toString().padStart(2, '0');
                } else {
                    return minutes + ':' + secs.toString().padStart(2, '0');
                }
            }
            
            formatFileSize(bytes) {
                const sizes = ['B', 'KB', 'MB', 'GB'];
                if (bytes === 0) return '0 B';
                const i = Math.floor(Math.log(bytes) / Math.log(1024));
                return (bytes / Math.pow(1024, i)).toFixed(2) + ' ' + sizes[i];
            }
        }
        
        // ÂàùÂßãÂåñÊáâÁî®Á®ãÂºè
        const app = new VideoApp();
        window.videoApp = app;
        
    })();
    </script>
</body>
</html>