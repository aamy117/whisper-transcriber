# WASM 本地轉譯功能詳細說明

## 功能概述

WASM（WebAssembly）本地轉譯功能允許使用者在瀏覽器中直接進行語音轉文字處理，無需上傳檔案到雲端，提供完整的隱私保護和離線使用能力。

## 核心優勢

### 🔒 隱私保護
- 所有處理在本地瀏覽器中完成
- 音訊檔案不會離開您的電腦
- 無需擔心敏感內容外洩

### 💰 免費使用
- 無需 API 金鑰
- 無使用次數限制
- 無需支付 API 費用

### 🌐 離線操作
- 首次下載模型後可完全離線使用
- 不受網路品質影響
- 隨時隨地可用

### 📦 無檔案限制
- 不受 25MB 檔案大小限制
- 可處理任意長度的音訊
- 自動管理記憶體使用

## 技術架構

### 核心模組
```
js/wasm/
├── whisper-wasm-manager.js    # 管理器核心
├── whisper-transformers.js    # Transformers.js 實現
└── whisper-wasm-real.js       # Whisper.cpp 備用實現

js/workers/
└── whisper-worker.js          # Web Worker 背景處理
```

### 技術實現
1. **Transformers.js**：主要實現方案，使用 Hugging Face 模型
2. **Web Workers**：背景執行緒處理，不阻塞主 UI
3. **IndexedDB**：模型快取，避免重複下載
4. **WebAssembly**：高效能運算核心

## 模型選擇指南

### Tiny 模型（39MB）
- **優點**：下載快速、處理速度快、佔用記憶體少
- **缺點**：準確度相對較低
- **適用場景**：快速預覽、初步轉譯、低配置設備

### Base 模型（74MB）
- **優點**：速度與品質平衡、適中的資源消耗
- **缺點**：準確度仍有提升空間
- **適用場景**：日常使用、一般轉譯需求、推薦選擇

### Small 模型（244MB）
- **優點**：最高準確度、專業級品質
- **缺點**：下載時間長、處理速度慢、需要較多記憶體
- **適用場景**：專業轉譯、重要文件、高品質要求

## 使用流程

### 1. 選擇轉譯方式
當您點擊「開始轉譯」時，系統會顯示轉譯方式選擇對話框：
- **本地轉譯**：使用 WASM 在瀏覽器中處理
- **雲端 API**：使用 OpenAI Whisper API

### 2. 選擇模型（首次使用）
如果選擇本地轉譯，首次使用需要選擇模型：
- 系統會顯示三種模型選項
- 選擇後自動下載模型檔案
- 下載進度即時顯示

### 3. 模型載入
- 首次載入需要初始化（約 10-30 秒）
- 模型會快取到 IndexedDB
- 後續使用直接從快取載入

### 4. 轉譯處理
- 自動偵測語言
- 即時顯示處理進度
- 支援取消操作

### 5. 結果處理
- 自動進行簡繁轉換
- 生成標點符號版本
- 與 API 結果格式一致

## 效能表現

### 處理速度（預估）
| 模型 | 處理速度 | 10分鐘音訊 |
|------|----------|------------|
| Tiny | 2-3x 實時 | 3-5 分鐘 |
| Base | 1-2x 實時 | 5-10 分鐘 |
| Small | 0.5-1x 實時 | 10-20 分鐘 |

### 系統需求
- **最低配置**：4GB RAM、雙核心 CPU
- **建議配置**：8GB RAM、四核心 CPU
- **瀏覽器**：Chrome 88+、Firefox 89+、Edge 88+、Safari 15.4+

## 進階設定

### 開發模式配置
```javascript
// transcription-preprocessor.js
this.ENABLE_WASM = true;        // 啟用 WASM 功能
this.ENABLE_REAL_WASM = false;  // 開發模式（模擬）
```

### 生產環境配置
```javascript
// transcription-preprocessor.js
this.ENABLE_WASM = true;        // 啟用 WASM 功能
this.ENABLE_REAL_WASM = true;   // 生產模式（真實）
```

## 常見問題

### Q: 模型下載失敗怎麼辦？
A: 
1. 檢查網路連線
2. 清除瀏覽器快取重試
3. 嘗試使用較小的模型
4. 確保有足夠的儲存空間

### Q: 轉譯速度很慢？
A: 
1. 選擇較小的模型（Tiny 或 Base）
2. 關閉其他佔用資源的程式
3. 使用較新的瀏覽器版本
4. 考慮升級硬體配置

### Q: 轉譯結果不準確？
A: 
1. 升級到更大的模型（Base 或 Small）
2. 確保音訊品質良好
3. 減少背景噪音
4. 使用單一語言音訊

### Q: 支援哪些音訊格式？
A: 支援所有瀏覽器可播放的格式：
- MP3、WAV、M4A、FLAC
- OGG、WEBM、MP4（音訊軌）

### Q: 可以同時處理多個檔案嗎？
A: 目前一次只能處理一個檔案，但您可以：
1. 使用批次處理頁面（batch.html）
2. 依序處理多個檔案
3. 考慮合併音訊後處理

## 隱私聲明

使用 WASM 本地轉譯時：
- ✅ 音訊檔案不會上傳到任何伺服器
- ✅ 轉譯完全在您的瀏覽器中進行
- ✅ 模型檔案儲存在本地 IndexedDB
- ✅ 無需網路連線（模型下載後）
- ✅ 我們無法存取您的音訊內容

## 技術限制

1. **瀏覽器限制**
   - 需要支援 WebAssembly
   - 需要足夠的記憶體
   - 某些行動瀏覽器可能不支援

2. **效能限制**
   - 處理速度取決於硬體
   - 大檔案可能需要較長時間
   - 同時處理會影響瀏覽器效能

3. **功能限制**
   - 目前僅支援單語言轉譯
   - 不支援即時串流轉譯
   - 模型大小有限制

## 未來計畫

1. **新增模型**
   - Medium 模型（約 1.5GB）
   - Large 模型（約 3GB）
   - 多語言專用模型

2. **效能優化**
   - GPU 加速（WebGPU）
   - 更好的記憶體管理
   - 串流式處理

3. **功能增強**
   - 語音活動檢測（VAD）
   - 自訂詞彙表
   - 即時轉譯支援

## 結語

WASM 本地轉譯功能為 Whisper 轉譯器提供了完整的離線解決方案，在保護隱私的同時提供專業級的轉譯品質。無論是個人使用還是處理敏感內容，都是理想的選擇。

隨著技術的進步和模型的優化，本地轉譯的效能和品質將持續提升，為使用者提供更好的體驗。

---

最後更新：2025 年 1 月