# WASM 優化版疑難排解

## 常見問題

### 1. SharedArrayBuffer 不可用

**錯誤訊息**：
```
SharedArrayBuffer 不可用，降級到單執行緒模式
```

**原因**：
瀏覽器安全政策要求特定的 HTTP headers 才能使用 SharedArrayBuffer。

**解決方案**：

#### 本地開發環境
1. 使用 HTTPS（即使是 localhost）
2. 設定正確的 HTTP headers
3. 或使用標準版（自動降級）

#### GitHub Pages
- GitHub Pages 不支援自訂 headers
- 系統會自動使用標準版
- 效能約為優化版的 1/4

### 2. Worker 載入失敗

**錯誤訊息**：
```
優化版引擎初始化失敗，降級到標準版
```

**原因**：
- Worker 檔案路徑錯誤
- 瀏覽器安全限制

**解決方案**：
- 系統會自動降級到標準版
- 無需手動處理

### 3. SIMD 不支援

**錯誤訊息**：
```
SIMD 不支援，效能可能較低
```

**原因**：
- 瀏覽器版本過舊
- SIMD 功能未啟用

**解決方案**：
- 更新瀏覽器到最新版本
- Chrome: 在 chrome://flags 啟用 WebAssembly SIMD

## 效能比較

| 環境 | SharedArrayBuffer | SIMD | 預期速度 |
|------|------------------|------|----------|
| 完整優化 | ✅ | ✅ | 4-16x |
| 單執行緒+SIMD | ❌ | ✅ | 2-4x |
| 標準版 | ❌ | ❌ | 1x |

## 建議

### 一般使用者
- 直接使用，系統會自動選擇最佳配置
- 降級不影響轉譯品質，只影響速度

### 進階使用者
1. 本地開發：設定 HTTPS 和正確的 headers
2. 生產環境：考慮自建伺服器或使用支援的託管服務
3. 或接受標準版的效能（仍然比雲端 API 快）

## 測試工具

使用 `/test/test-wasm-optimized.html` 檢查環境支援：
- 自動檢測所有功能
- 顯示詳細的環境資訊
- 提供效能測試

## 結論

優化版雖然提供更好的效能，但標準版已經足夠快速且穩定。系統的自動降級機制確保在任何環境下都能正常運作。