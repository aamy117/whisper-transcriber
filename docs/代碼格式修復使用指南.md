# 代碼格式修復使用指南

## 概述
提供三種方式來自動修復 JavaScript 代碼格式問題：
1. **瀏覽器版本** - 最簡單，無需安裝
2. **Node.js 版本** - 功能最完整
3. **Shell 腳本** - Linux/Mac 快速修復

## 方法一：瀏覽器版本（推薦）

### 使用步驟
1. 在瀏覽器開啟 `auto-fix-browser.html`
   ```
   http://localhost:5500/auto-fix-browser.html
   ```

2. 拖放或選擇要修復的 JavaScript 檔案

3. 選擇要修復的問題類型：
   - ✅ 修復行尾空格
   - ✅ 修復多餘空行
   - ✅ 修復檔案結尾換行
   - ✅ 條件化 Console 語句

4. 點擊「修復所有問題」

5. 預覽修改結果

6. 點擊「下載修復後的檔案」

### 特點
- 視覺化介面
- 即時預覽
- 批次處理
- 無需安裝任何工具

## 方法二：Node.js 版本

### 前置需求
- 安裝 Node.js（版本 12+）

### 使用步驟

#### Windows
```batch
# 執行批次檔
fix-all-format.bat

# 或直接使用 Node.js
node auto-fix-code.js
```

#### Linux/Mac
```bash
# 直接使用 Node.js
node auto-fix-code.js

# 查看幫助
node auto-fix-code.js --help
```

### 命令選項
```bash
# 基本使用
node auto-fix-code.js

# 不處理 console 語句
node auto-fix-code.js --no-console

# 不建立備份檔案
node auto-fix-code.js --no-backup

# 安靜模式（減少輸出）
node auto-fix-code.js --quiet

# 預覽模式（不實際修改）
node auto-fix-code.js --dry-run
```

### 特點
- 自動遞歸處理所有 JS 檔案
- 智能 console 語句處理
- 自動備份原始檔案
- 詳細的處理報告

## 方法三：Shell 腳本（Linux/Mac）

### 使用步驟
```bash
# 給予執行權限
chmod +x fix-all-format.sh

# 執行腳本
./fix-all-format.sh
```

### 特點
- 快速簡單
- 使用系統工具
- 適合 CI/CD 整合

## 修復內容說明

### 1. 行尾空格
```javascript
// 修復前
let name = "John";  ··
const age = 30;····

// 修復後
let name = "John";
const age = 30;
```

### 2. 多餘空行
```javascript
// 修復前
function test() {


    return true;


}

// 修復後
function test() {

    return true;

}
```

### 3. Console 語句條件化
```javascript
// 修復前
console.log('Debug info');
console.error('Error occurred');

// 修復後
const DEBUG = location.hostname === 'localhost';
DEBUG && console.log('Debug info');
DEBUG && console.error('Error occurred');
```

### 4. 檔案結尾換行
```javascript
// 修復前
export default MyClass;[EOF]

// 修復後
export default MyClass;
[EOF]
```

## 注意事項

### 備份
- Node.js 版本會自動建立 `.backup` 檔案
- 瀏覽器版本不會覆蓋原始檔案
- 建議先使用版本控制提交現有代碼

### 測試
修復後請務必：
1. 執行所有測試
2. 檢查程式功能
3. 使用 `git diff` 查看變更

### Console 語句處理
- 保留 `console.error` 用於錯誤記錄
- 其他 console 語句加上 DEBUG 條件
- 可選擇不處理 console 語句

## 整合到工作流程

### Git Hooks (pre-commit)
```bash
#!/bin/sh
# .git/hooks/pre-commit
node auto-fix-code.js --quiet
git add -u
```

### VS Code 設定
```json
{
  "files.trimTrailingWhitespace": true,
  "files.insertFinalNewline": true,
  "editor.formatOnSave": true
}
```

### ESLint 整合
```json
{
  "rules": {
    "no-trailing-spaces": "error",
    "eol-last": "error",
    "no-multiple-empty-lines": ["error", { "max": 2 }],
    "no-console": "warn"
  }
}
```

## 故障排除

### 問題：檔案編碼錯誤
- 確保檔案使用 UTF-8 編碼
- 使用編輯器轉換編碼

### 問題：修復後程式出錯
- 檢查 console 語句是否被錯誤包裝
- 使用備份檔案還原
- 手動檢查特殊情況

### 問題：某些檔案未被處理
- 檢查檔案副檔名是否為 .js
- 確認不在忽略列表中
- 檢查檔案權限

## 最佳實踐

1. **定期執行**：每次提交前執行一次
2. **團隊統一**：確保團隊使用相同的格式規則
3. **自動化**：整合到 CI/CD 流程
4. **版本控制**：修復前先提交現有代碼
5. **逐步修復**：大專案可分批處理

## 結語

使用這些工具可以快速統一代碼格式，提高代碼品質。建議從瀏覽器版本開始，熟悉後再使用命令列工具進行自動化。