<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¦–è¨Šæ’­æ”¾å™¨ - ç„¡æ¨¡çµ„ç‰ˆ</title>
    <link rel="stylesheet" href="css/shared.css">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/video.css">
</head>
<body>
    <!-- å°èˆªåˆ— -->
    <nav class="app-navigation">
        <div class="nav-container">
            <div class="nav-brand">
                <h1 class="nav-title">Whisper å·¥å…·</h1>
            </div>
            <div class="nav-links">
                <a href="index.html" class="nav-link">
                    <span class="nav-icon">ğŸµ</span>
                    <span>éŸ³è¨Šå·¥å…·</span>
                </a>
                <a href="video.html" class="nav-link active">
                    <span class="nav-icon">ğŸ¬</span>
                    <span>è¦–è¨Šå·¥å…·</span>
                </a>
            </div>
        </div>
    </nav>

    <div id="video-app">
        <header class="app-header">
            <div class="container">
                <h1 class="app-title">è¦–è¨Šæ’­æ”¾å™¨ï¼ˆç„¡æ¨¡çµ„ç‰ˆï¼‰</h1>
            </div>
        </header>

        <main class="video-main">
            <div class="video-layout">
                <!-- å·¦å´ï¼šè¦–è¨Šæ’­æ”¾å€ -->
                <section class="video-section">
                    <!-- ä¸Šå‚³å€åŸŸ -->
                    <div class="video-upload-area" id="videoUploadArea">
                        <div class="upload-content">
                            <span class="upload-icon">ğŸ¬</span>
                            <h2>ä¸Šå‚³å½±ç‰‡æª”æ¡ˆ</h2>
                            <p>æ‹–æ”¾æª”æ¡ˆåˆ°æ­¤è™•ï¼Œæˆ–é»æ“Šé¸æ“‡æª”æ¡ˆ</p>
                            <p class="upload-hint">æ”¯æ´æ ¼å¼ï¼šMP4ã€WebMã€OGVï¼ˆæœ€å¤§ 2GBï¼‰</p>
                            <input type="file" id="videoInput" accept="video/*" hidden>
                            <button class="btn btn-primary" id="selectVideoBtn">é¸æ“‡æª”æ¡ˆ</button>
                        </div>
                    </div>

                    <!-- è¦–è¨Šæ’­æ”¾å™¨å®¹å™¨ -->
                    <div class="video-player-container hidden" id="videoPlayerContainer">
                        <div class="video-wrapper" id="videoWrapper">
                            <video id="videoPlayer" controls></video>
                        </div>
                    </div>
                </section>

                <!-- å³å´ï¼šåŠŸèƒ½é¢æ¿ -->
                <aside class="side-panel">
                    <div class="panel-tabs">
                        <button class="tab-btn active" data-tab="info">å½±ç‰‡è³‡è¨Š</button>
                    </div>
                    <div class="panel-content active" id="infoPanel">
                        <div class="video-info">
                            <h3>å½±ç‰‡è³‡è¨Š</h3>
                            <div class="info-item">
                                <span class="info-label">æª”æ¡ˆåç¨±ï¼š</span>
                                <span class="info-value" id="videoFileName">-</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">æª”æ¡ˆå¤§å°ï¼š</span>
                                <span class="info-value" id="videoFileSize">-</span>
                            </div>
                        </div>
                    </div>
                </aside>
            </div>
        </main>
    </div>

    <!-- ç›´æ¥çš„ JavaScriptï¼Œä¸ä½¿ç”¨æ¨¡çµ„ -->
    <script>
        console.log('é–‹å§‹åŸ·è¡Œ JavaScript...');
        
        // ç­‰å¾… DOM è¼‰å…¥
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM è¼‰å…¥å®Œæˆ');
            
            // å–å¾—å…ƒç´ 
            const fileInput = document.getElementById('videoInput');
            const selectBtn = document.getElementById('selectVideoBtn');
            const uploadArea = document.getElementById('videoUploadArea');
            const videoPlayer = document.getElementById('videoPlayer');
            const playerContainer = document.getElementById('videoPlayerContainer');
            const fileName = document.getElementById('videoFileName');
            const fileSize = document.getElementById('videoFileSize');
            
            console.log('å…ƒç´ ç‹€æ…‹:', {
                fileInput: !!fileInput,
                selectBtn: !!selectBtn,
                uploadArea: !!uploadArea,
                videoPlayer: !!videoPlayer
            });
            
            if (!fileInput || !selectBtn) {
                console.error('æ‰¾ä¸åˆ°å¿…è¦å…ƒç´ ');
                return;
            }
            
            // ç¶å®šé¸æ“‡æŒ‰éˆ•
            selectBtn.addEventListener('click', function() {
                console.log('æŒ‰éˆ•è¢«é»æ“Š');
                fileInput.click();
            });
            
            // ç¶å®šæª”æ¡ˆé¸æ“‡
            fileInput.addEventListener('change', function(e) {
                console.log('æª”æ¡ˆé¸æ“‡è§¸ç™¼');
                const file = e.target.files[0];
                
                if (file) {
                    console.log('é¸æ“‡çš„æª”æ¡ˆ:', file.name, file.type, file.size);
                    
                    if (file.type.startsWith('video/')) {
                        // é¡¯ç¤ºæª”æ¡ˆè³‡è¨Š
                        fileName.textContent = file.name;
                        fileSize.textContent = formatFileSize(file.size);
                        
                        // è¼‰å…¥è¦–è¨Š
                        const url = URL.createObjectURL(file);
                        videoPlayer.src = url;
                        
                        // é¡¯ç¤ºæ’­æ”¾å™¨
                        uploadArea.classList.add('hidden');
                        playerContainer.classList.remove('hidden');
                        
                        console.log('è¦–è¨Šè¼‰å…¥å®Œæˆ');
                    } else {
                        alert('è«‹é¸æ“‡è¦–è¨Šæª”æ¡ˆ');
                    }
                }
            });
            
            // æ‹–æ”¾åŠŸèƒ½
            uploadArea.addEventListener('dragover', function(e) {
                e.preventDefault();
                uploadArea.classList.add('drag-over');
            });
            
            uploadArea.addEventListener('dragleave', function() {
                uploadArea.classList.remove('drag-over');
            });
            
            uploadArea.addEventListener('drop', function(e) {
                e.preventDefault();
                uploadArea.classList.remove('drag-over');
                
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    fileInput.files = files;
                    const event = new Event('change', { bubbles: true });
                    fileInput.dispatchEvent(event);
                }
            });
            
            // è¦–è¨Šäº‹ä»¶
            videoPlayer.addEventListener('loadedmetadata', function() {
                console.log('è¦–è¨Š metadata è¼‰å…¥:', {
                    duration: videoPlayer.duration,
                    width: videoPlayer.videoWidth,
                    height: videoPlayer.videoHeight
                });
            });
            
            videoPlayer.addEventListener('error', function(e) {
                console.error('è¦–è¨ŠéŒ¯èª¤:', e);
                alert('è¦–è¨Šè¼‰å…¥å¤±æ•—');
            });
            
            // æ ¼å¼åŒ–æª”æ¡ˆå¤§å°
            function formatFileSize(bytes) {
                const sizes = ['B', 'KB', 'MB', 'GB'];
                if (bytes === 0) return '0 B';
                const i = Math.floor(Math.log(bytes) / Math.log(1024));
                return (bytes / Math.pow(1024, i)).toFixed(2) + ' ' + sizes[i];
            }
            
            console.log('åˆå§‹åŒ–å®Œæˆ');
        });
    </script>
</body>
</html>