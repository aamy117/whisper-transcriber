<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>視訊播放器 - 無模組版</title>
    <link rel="stylesheet" href="css/shared.css">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/video.css">
</head>
<body>
    <!-- 導航列 -->
    <nav class="app-navigation">
        <div class="nav-container">
            <div class="nav-brand">
                <h1 class="nav-title">Whisper 工具</h1>
            </div>
            <div class="nav-links">
                <a href="index.html" class="nav-link">
                    <span class="nav-icon">🎵</span>
                    <span>音訊工具</span>
                </a>
                <a href="video.html" class="nav-link active">
                    <span class="nav-icon">🎬</span>
                    <span>視訊工具</span>
                </a>
            </div>
        </div>
    </nav>

    <div id="video-app">
        <header class="app-header">
            <div class="container">
                <h1 class="app-title">視訊播放器（無模組版）</h1>
            </div>
        </header>

        <main class="video-main">
            <div class="video-layout">
                <!-- 左側：視訊播放區 -->
                <section class="video-section">
                    <!-- 上傳區域 -->
                    <div class="video-upload-area" id="videoUploadArea">
                        <div class="upload-content">
                            <span class="upload-icon">🎬</span>
                            <h2>上傳影片檔案</h2>
                            <p>拖放檔案到此處，或點擊選擇檔案</p>
                            <p class="upload-hint">支援格式：MP4、WebM、OGV（最大 2GB）</p>
                            <input type="file" id="videoInput" accept="video/*" hidden>
                            <button class="btn btn-primary" id="selectVideoBtn">選擇檔案</button>
                        </div>
                    </div>

                    <!-- 視訊播放器容器 -->
                    <div class="video-player-container hidden" id="videoPlayerContainer">
                        <div class="video-wrapper" id="videoWrapper">
                            <video id="videoPlayer" controls></video>
                        </div>
                    </div>
                </section>

                <!-- 右側：功能面板 -->
                <aside class="side-panel">
                    <div class="panel-tabs">
                        <button class="tab-btn active" data-tab="info">影片資訊</button>
                    </div>
                    <div class="panel-content active" id="infoPanel">
                        <div class="video-info">
                            <h3>影片資訊</h3>
                            <div class="info-item">
                                <span class="info-label">檔案名稱：</span>
                                <span class="info-value" id="videoFileName">-</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">檔案大小：</span>
                                <span class="info-value" id="videoFileSize">-</span>
                            </div>
                        </div>
                    </div>
                </aside>
            </div>
        </main>
    </div>

    <!-- 直接的 JavaScript，不使用模組 -->
    <script>
        console.log('開始執行 JavaScript...');
        
        // 等待 DOM 載入
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM 載入完成');
            
            // 取得元素
            const fileInput = document.getElementById('videoInput');
            const selectBtn = document.getElementById('selectVideoBtn');
            const uploadArea = document.getElementById('videoUploadArea');
            const videoPlayer = document.getElementById('videoPlayer');
            const playerContainer = document.getElementById('videoPlayerContainer');
            const fileName = document.getElementById('videoFileName');
            const fileSize = document.getElementById('videoFileSize');
            
            console.log('元素狀態:', {
                fileInput: !!fileInput,
                selectBtn: !!selectBtn,
                uploadArea: !!uploadArea,
                videoPlayer: !!videoPlayer
            });
            
            if (!fileInput || !selectBtn) {
                console.error('找不到必要元素');
                return;
            }
            
            // 綁定選擇按鈕
            selectBtn.addEventListener('click', function() {
                console.log('按鈕被點擊');
                fileInput.click();
            });
            
            // 綁定檔案選擇
            fileInput.addEventListener('change', function(e) {
                console.log('檔案選擇觸發');
                const file = e.target.files[0];
                
                if (file) {
                    console.log('選擇的檔案:', file.name, file.type, file.size);
                    
                    if (file.type.startsWith('video/')) {
                        // 顯示檔案資訊
                        fileName.textContent = file.name;
                        fileSize.textContent = formatFileSize(file.size);
                        
                        // 載入視訊
                        const url = URL.createObjectURL(file);
                        videoPlayer.src = url;
                        
                        // 顯示播放器
                        uploadArea.classList.add('hidden');
                        playerContainer.classList.remove('hidden');
                        
                        console.log('視訊載入完成');
                    } else {
                        alert('請選擇視訊檔案');
                    }
                }
            });
            
            // 拖放功能
            uploadArea.addEventListener('dragover', function(e) {
                e.preventDefault();
                uploadArea.classList.add('drag-over');
            });
            
            uploadArea.addEventListener('dragleave', function() {
                uploadArea.classList.remove('drag-over');
            });
            
            uploadArea.addEventListener('drop', function(e) {
                e.preventDefault();
                uploadArea.classList.remove('drag-over');
                
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    fileInput.files = files;
                    const event = new Event('change', { bubbles: true });
                    fileInput.dispatchEvent(event);
                }
            });
            
            // 視訊事件
            videoPlayer.addEventListener('loadedmetadata', function() {
                console.log('視訊 metadata 載入:', {
                    duration: videoPlayer.duration,
                    width: videoPlayer.videoWidth,
                    height: videoPlayer.videoHeight
                });
            });
            
            videoPlayer.addEventListener('error', function(e) {
                console.error('視訊錯誤:', e);
                alert('視訊載入失敗');
            });
            
            // 格式化檔案大小
            function formatFileSize(bytes) {
                const sizes = ['B', 'KB', 'MB', 'GB'];
                if (bytes === 0) return '0 B';
                const i = Math.floor(Math.log(bytes) / Math.log(1024));
                return (bytes / Math.pow(1024, i)).toFixed(2) + ' ' + sizes[i];
            }
            
            console.log('初始化完成');
        });
    </script>
</body>
</html>